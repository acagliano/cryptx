\doxysection{/\+Users/acagliano/\+Repositories/toolchain/src/cryptx/cryptx.h}
\hypertarget{cryptx_8h_source}{}\label{cryptx_8h_source}\mbox{\hyperlink{cryptx_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#ifndef\ cryptx\_h}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#define\ cryptx\_h}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <stdint.h>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <stdbool.h>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <stddef.h>}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ \ PRIVATE/OPAQUE\ STRUCTURES\ \ \ -\/-\/-\/-\/-\/\ \ \ DO\ NOT\ MODIFY!\ THINGS\ WILL\ BREAK!}}
\DoxyCodeLine{00016\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00017\ \textcolor{comment}{/*\ @internal\ */}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{comment}{//\ Private\ Struct\ Definitions\ for\ Hash\ State\ Contexts}}
\DoxyCodeLine{00020\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcryptx__priv__hash__sha256__state}{cryptx\_priv\_hash\_sha256\_state}}\ \{}
\DoxyCodeLine{00021\ \ \ \ \ uint8\_t\ \mbox{\hyperlink{structcryptx__priv__hash__sha256__state_a6fcedd1c789a695a3a181a7a6624d368}{data}}[64];\ \ \ \ \ \ \ }
\DoxyCodeLine{00022\ \ \ \ \ uint8\_t\ \mbox{\hyperlink{structcryptx__priv__hash__sha256__state_ace5c23e2acbfc3932b3b282d5bbf59f0}{datalen}};\ \ \ \ \ }
\DoxyCodeLine{00023\ \ \ \ \ uint8\_t\ \mbox{\hyperlink{structcryptx__priv__hash__sha256__state_a4c215841f9afc43636ec7f6142ae2642}{bitlen}}[8];\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00024\ \ \ \ \ uint32\_t\ \mbox{\hyperlink{structcryptx__priv__hash__sha256__state_a4e4b779e16b0ef55728be88db5aef714}{state}}[8];\ \ \ \ \ }
\DoxyCodeLine{00025\ \};}
\DoxyCodeLine{00026\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcryptx__priv__hash__sha256__state}{cryptx\_priv\_hash\_sha256\_state}}\ sha256;}
\DoxyCodeLine{00028\ \}\ \mbox{\hyperlink{unioncryptx__hash__private__h}{cryptx\_hash\_private\_h}};}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{comment}{//\ Private\ Struct\ Definitions\ for\ HMAC\ State\ Contexts}}
\DoxyCodeLine{00031\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcryptx__priv__hmac__sha256__state}{cryptx\_priv\_hmac\_sha256\_state}}\ \{}
\DoxyCodeLine{00032\ \ \ \ \ uint8\_t\ \mbox{\hyperlink{structcryptx__priv__hmac__sha256__state_a7a76c33feb53451f32a650e2d9568d36}{ipad}}[64];\ \ \ \ \ \ \ }
\DoxyCodeLine{00033\ \ \ \ \ uint8\_t\ \mbox{\hyperlink{structcryptx__priv__hmac__sha256__state_acce0aef7c236c61aa651f5479019e718}{opad}}[64];\ \ \ \ \ \ \ }
\DoxyCodeLine{00034\ \ \ \ \ uint8\_t\ \mbox{\hyperlink{structcryptx__priv__hmac__sha256__state_a6fcedd1c789a695a3a181a7a6624d368}{data}}[64];\ \ \ \ \ \ \ }
\DoxyCodeLine{00035\ \ \ \ \ uint8\_t\ \mbox{\hyperlink{structcryptx__priv__hmac__sha256__state_ace5c23e2acbfc3932b3b282d5bbf59f0}{datalen}};\ \ \ \ \ }
\DoxyCodeLine{00036\ \ \ \ \ uint8\_t\ \mbox{\hyperlink{structcryptx__priv__hmac__sha256__state_a4c215841f9afc43636ec7f6142ae2642}{bitlen}}[8];\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00037\ \ \ \ \ uint32\_t\ \mbox{\hyperlink{structcryptx__priv__hmac__sha256__state_a4e4b779e16b0ef55728be88db5aef714}{state}}[8];\ \ \ \ \ }
\DoxyCodeLine{00038\ \};}
\DoxyCodeLine{00039\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcryptx__priv__hmac__sha256__state}{cryptx\_priv\_hmac\_sha256\_state}}\ sha256;}
\DoxyCodeLine{00041\ \}\ \mbox{\hyperlink{unioncryptx__hmac__private__h}{cryptx\_hmac\_private\_h}};}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcryptx__aes__cbc__state}{cryptx\_aes\_cbc\_state}}\ \{\ uint8\_t\ padding\_mode;\ \};}
\DoxyCodeLine{00044\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcryptx__aes__ctr__state}{cryptx\_aes\_ctr\_state}}\ \{}
\DoxyCodeLine{00045\ \ \ \ \ uint8\_t\ counter\_pos\_start;\ uint8\_t\ counter\_len;}
\DoxyCodeLine{00046\ \ \ \ \ uint8\_t\ last\_block\_stop;\ uint8\_t\ last\_block[16];\ \};}
\DoxyCodeLine{00047\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcryptx__aes__gcm__state}{cryptx\_aes\_gcm\_state}}\ \{}
\DoxyCodeLine{00048\ \ \ \ \ uint8\_t\ last\_block\_stop;\ uint8\_t\ last\_block[16];}
\DoxyCodeLine{00049\ \ \ \ \ uint8\_t\ ghash\_key[16];}
\DoxyCodeLine{00050\ \ \ \ \ uint8\_t\ aad\_cache[16];\ uint8\_t\ auth\_tag[16];\ uint8\_t\ auth\_j0[16];}
\DoxyCodeLine{00051\ \ \ \ \ uint8\_t\ aad\_cache\_len;\ \textcolor{keywordtype}{size\_t}\ aad\_len;\ \textcolor{keywordtype}{size\_t}\ ct\_len;}
\DoxyCodeLine{00052\ \ \ \ \ uint8\_t\ gcm\_op;}
\DoxyCodeLine{00053\ \};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcryptx__aes__gcm__state}{cryptx\_aes\_gcm\_state}}\ gcm;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcryptx__aes__cbc__state}{cryptx\_aes\_cbc\_state}}\ ctr;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcryptx__aes__ctr__state}{cryptx\_aes\_ctr\_state}}\ cbc;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00059\ \}\ \mbox{\hyperlink{unioncryptx__aes__private__h}{cryptx\_aes\_private\_h}};}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00062\ \textcolor{comment}{//\ \ HASHING}}
\DoxyCodeLine{00063\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00066\ \textcolor{comment}{}\textcolor{keyword}{struct\ }\mbox{\hyperlink{structcryptx__hash__ctx}{cryptx\_hash\_ctx}}\ \{}
\DoxyCodeLine{00067\ \ \ \ \ bool\ (*init)(\textcolor{keywordtype}{void}*\ ctx);}
\DoxyCodeLine{00068\ \ \ \ \ void\ (*update)(\textcolor{keywordtype}{void}*\ ctx,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ data,\ \textcolor{keywordtype}{size\_t}\ len);}
\DoxyCodeLine{00069\ \ \ \ \ void\ (*digest)(\textcolor{keywordtype}{void}*\ ctx,\ \textcolor{keywordtype}{void}*\ output);}
\DoxyCodeLine{00070\ \ \ \ \ uint8\_t\ digest\_len;}
\DoxyCodeLine{00071\ \ \ \ \ \mbox{\hyperlink{unioncryptx__hash__private__h}{cryptx\_hash\_private\_h}}\ metadata;}
\DoxyCodeLine{00072\ \};}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{cryptx_8h_a57f2f69b5ad395749c8604ca9f43f93b}{cryptx\_hash\_algorithms}}\ \{}
\DoxyCodeLine{00075\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a57f2f69b5ad395749c8604ca9f43f93bac7716785728694693ec29eccd5ffa0e1}{SHA256}},\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00076\ \};}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00079\ \textcolor{comment}{\ *\ \ @brief\ Initializes\ a\ hash-\/state\ context\ for\ a\ specific\ hash\ algorithm.}}
\DoxyCodeLine{00080\ \textcolor{comment}{\ *\ \ @param[in]\ context\ \ Pointer\ to\ a\ hash-\/state\ context.}}
\DoxyCodeLine{00081\ \textcolor{comment}{\ *\ \ @param[in]\ hash\_alg\ The\ numeric\ ID\ of\ the\ hashing\ algorithm\ to\ use.\ See\ @b\ cryptx\_hash\_algorithms.}}
\DoxyCodeLine{00082\ \textcolor{comment}{\ *\ \ @return\ @b\ true\ if\ hash\ initialization\ succeeded,\ @b\ false\ if\ failed.}}
\DoxyCodeLine{00083\ \textcolor{comment}{\ *\ \ @note\ Uses\ 516\ bytes\ of\ fastMem\ starting\ at\ 0xE30800.}}
\DoxyCodeLine{00084\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00085\ \textcolor{keywordtype}{bool}\ cryptx\_hash\_init(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__hash__ctx}{cryptx\_hash\_ctx}}*\ context,\ uint8\_t\ hash\_alg);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00088\ \textcolor{comment}{\ *\ \ @brief\ Updates\ the\ hash-\/state\ for\ a\ given\ block\ of\ data.}}
\DoxyCodeLine{00089\ \textcolor{comment}{\ *\ \ @param[in]\ context\ \ Pointer\ to\ a\ hash-\/state\ context.}}
\DoxyCodeLine{00090\ \textcolor{comment}{\ *\ \ @param[in]\ data\ \ \ \ \ Pointer\ to\ a\ block\ of\ data\ to\ hash..}}
\DoxyCodeLine{00091\ \textcolor{comment}{\ *\ \ @param[in]\ len\ \ \ \ \ \ Size\ of\ the\ @b\ data\ to\ hash.}}
\DoxyCodeLine{00092\ \textcolor{comment}{\ *\ \ @note\ Uses\ 516\ bytes\ of\ fastMem\ starting\ at\ 0xE30800.}}
\DoxyCodeLine{00093\ \textcolor{comment}{\ *\ \ @warning\ Calling\ this\ on\ a\ context\ that\ has\ not\ been\ initialized\ may\ have}}
\DoxyCodeLine{00094\ \textcolor{comment}{\ *\ \ unpredictable\ results.}}
\DoxyCodeLine{00095\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00096\ \textcolor{keywordtype}{void}\ cryptx\_hash\_update(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__hash__ctx}{cryptx\_hash\_ctx}}*\ context,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ data,\ \textcolor{keywordtype}{size\_t}\ len);}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00099\ \textcolor{comment}{\ *\ \ @brief\ Output\ digest\ for\ current\ hash-\/state\ (preserves\ state).}}
\DoxyCodeLine{00100\ \textcolor{comment}{\ *\ \ @param[in]\ context\ \ Pointer\ to\ a\ hash-\/state\ context.}}
\DoxyCodeLine{00101\ \textcolor{comment}{\ *\ \ @param[out]\ digest\ \ Pointer\ to\ a\ buffer\ to\ write\ digest\ to.}}
\DoxyCodeLine{00102\ \textcolor{comment}{\ *\ \ @note\ @b\ digest\ must\ be\ at\ large\ enough\ to\ hold\ the\ hash\ digest.}}
\DoxyCodeLine{00103\ \textcolor{comment}{\ *\ \ You\ can\ retrieve\ the\ necessary\ size\ by\ accessing\ the\ @b\ digest\_len}}
\DoxyCodeLine{00104\ \textcolor{comment}{\ *\ \ member\ of\ an\ initialized\ @b\ cryptx\_hash\_ctx.}}
\DoxyCodeLine{00105\ \textcolor{comment}{\ *\ \ @note\ Uses\ 516\ bytes\ of\ fastMem\ starting\ at\ 0xE30800.}}
\DoxyCodeLine{00106\ \textcolor{comment}{\ *\ \ @warning\ Calling\ this\ on\ a\ context\ that\ has\ not\ been\ initialized\ may\ have}}
\DoxyCodeLine{00107\ \textcolor{comment}{\ *\ \ unpredictable\ results.}}
\DoxyCodeLine{00108\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00109\ \textcolor{keywordtype}{void}\ cryptx\_hash\_digest(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__hash__ctx}{cryptx\_hash\_ctx}}*\ context,\ \textcolor{keywordtype}{void}*\ digest);}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00112\ \textcolor{comment}{\ *\ \ @brief\ Computes\ a\ digest\ of\ arbitrary\ length\ for\ a\ given\ block\ of\ data.}}
\DoxyCodeLine{00113\ \textcolor{comment}{\ *\ \ @param[in]\ \ data\ \ \ \ Pointer\ to\ data\ to\ hash.}}
\DoxyCodeLine{00114\ \textcolor{comment}{\ *\ \ @param[in]\ \ datalen\ Size\ of\ @b\ data\ to\ hash.}}
\DoxyCodeLine{00115\ \textcolor{comment}{\ *\ \ @param[out]\ outbuf\ \ Pointer\ to\ buffer\ to\ write\ digest\ to.}}
\DoxyCodeLine{00116\ \textcolor{comment}{\ *\ \ @param[in]\ \ outlen\ \ Number\ of\ bytes\ to\ write\ to\ @b\ outbuf.}}
\DoxyCodeLine{00117\ \textcolor{comment}{\ *\ \ @param[in]\ \ hash\_alg\ \ \ \ The\ numeric\ ID\ of\ the\ hashing\ algorithm\ to\ use.\ See\ @b\ cryptx\_hash\_algorithms.}}
\DoxyCodeLine{00118\ \textcolor{comment}{\ *\ \ @note\ @b\ outbuf\ must\ be\ at\ least\ @b\ outlen\ bytes\ large.}}
\DoxyCodeLine{00119\ \textcolor{comment}{\ *\ \ @note\ Uses\ 516\ bytes\ of\ fastMem\ starting\ at\ 0xE30800.}}
\DoxyCodeLine{00120\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00121\ \textcolor{keywordtype}{void}\ cryptx\_hash\_mgf1(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ data,}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ datalen,}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}*\ outbuf,}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ outlen,}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ hash\_alg);}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00129\ \textcolor{comment}{//\ \ HASH-\/BASED\ MESSAGE\ AUTHENTICATION\ CODE\ (HMAC)}}
\DoxyCodeLine{00130\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00133\ \textcolor{comment}{}\textcolor{keyword}{struct\ }\mbox{\hyperlink{structcryptx__hmac__ctx}{cryptx\_hmac\_ctx}}\ \{}
\DoxyCodeLine{00134\ \ \ \ \ bool\ (*init)(\textcolor{keywordtype}{void}*\ ctx,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ key,\ \textcolor{keywordtype}{size\_t}\ keylen);}
\DoxyCodeLine{00135\ \ \ \ \ void\ (*update)(\textcolor{keywordtype}{void}*\ ctx,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ data,\ \textcolor{keywordtype}{size\_t}\ len);}
\DoxyCodeLine{00136\ \ \ \ \ void\ (*digest)(\textcolor{keywordtype}{void}*\ ctx,\ \textcolor{keywordtype}{void}*\ output);}
\DoxyCodeLine{00137\ \ \ \ \ uint8\_t\ digest\_len;}
\DoxyCodeLine{00138\ \ \ \ \ \mbox{\hyperlink{unioncryptx__hmac__private__h}{cryptx\_hmac\_private\_h}}\ metadata;}
\DoxyCodeLine{00139\ \};}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00142\ \textcolor{comment}{\ *\ \ @brief\ Initializes\ an\ HMAC-\/state\ context\ for\ a\ specific\ hash\ algorithm.}}
\DoxyCodeLine{00143\ \textcolor{comment}{\ *\ \ @param[in]\ context\ \ Pointer\ to\ an\ HMAC-\/state\ context.}}
\DoxyCodeLine{00144\ \textcolor{comment}{\ *\ \ @param[in]\ key\ \ \ \ \ \ Pointer\ to\ a\ key\ used\ to\ initialize\ the\ HMAC\ state.}}
\DoxyCodeLine{00145\ \textcolor{comment}{\ *\ \ @param[in]\ keylen\ \ \ Length\ of\ the\ @b\ key.}}
\DoxyCodeLine{00146\ \textcolor{comment}{\ *\ \ @param[in]\ hash\_alg\ The\ numeric\ ID\ of\ the\ hashing\ algorithm\ to\ use.\ See\ @b\ cryptx\_hash\_algorithms.}}
\DoxyCodeLine{00147\ \textcolor{comment}{\ *\ \ @return\ @b\ true\ if\ initialized\ succeeded,\ @b\ false\ if\ failed.}}
\DoxyCodeLine{00148\ \textcolor{comment}{\ *\ \ @note\ Uses\ 516\ bytes\ of\ fastMem\ starting\ at\ 0xE30800.}}
\DoxyCodeLine{00149\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00150\ \textcolor{keywordtype}{bool}\ cryptx\_hmac\_init(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__hmac__ctx}{cryptx\_hmac\_ctx}}*\ context,}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ key,\ \textcolor{keywordtype}{size\_t}\ keylen,}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ hash\_alg);}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00155\ \textcolor{comment}{\ *\ \ @brief\ Updates\ the\ hash-\/state\ for\ a\ given\ block\ of\ data.}}
\DoxyCodeLine{00156\ \textcolor{comment}{\ *\ \ @param[in]\ context\ \ Pointer\ to\ an\ HMAC-\/state\ context.}}
\DoxyCodeLine{00157\ \textcolor{comment}{\ *\ \ @param[in]\ data\ \ \ \ \ Pointer\ to\ a\ block\ of\ data\ to\ hash..}}
\DoxyCodeLine{00158\ \textcolor{comment}{\ *\ \ @param[in]\ len\ \ \ \ \ \ Size\ of\ the\ @b\ data\ to\ hash.}}
\DoxyCodeLine{00159\ \textcolor{comment}{\ *\ \ @note\ Uses\ 516\ bytes\ of\ fastMem\ starting\ at\ 0xE30800.}}
\DoxyCodeLine{00160\ \textcolor{comment}{\ *\ \ @warning\ Calling\ this\ on\ a\ context\ that\ has\ not\ been\ initialized\ may\ have}}
\DoxyCodeLine{00161\ \textcolor{comment}{\ *\ \ unpredictable\ results.}}
\DoxyCodeLine{00162\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00163\ \textcolor{keywordtype}{void}\ cryptx\_hmac\_update(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__hmac__ctx}{cryptx\_hmac\_ctx}}*\ context,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ data,\ \textcolor{keywordtype}{size\_t}\ len);}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00166\ \textcolor{comment}{\ *\ \ @brief\ Output\ digest\ for\ current\ HMAC-\/state\ (preserves\ state).}}
\DoxyCodeLine{00167\ \textcolor{comment}{\ *\ \ @param[in]\ context\ \ Pointer\ to\ an\ HMAC-\/state\ context.}}
\DoxyCodeLine{00168\ \textcolor{comment}{\ *\ \ @param[out]\ digest\ \ Pointer\ to\ a\ buffer\ to\ write\ digest\ to.}}
\DoxyCodeLine{00169\ \textcolor{comment}{\ *\ \ @note\ @b\ digest\ must\ be\ at\ large\ enough\ to\ hold\ the\ hash\ digest.}}
\DoxyCodeLine{00170\ \textcolor{comment}{\ *\ \ You\ can\ retrieve\ the\ necessary\ size\ by\ accessing\ the\ @b\ digest\_len}}
\DoxyCodeLine{00171\ \textcolor{comment}{\ *\ \ member\ of\ an\ initialized\ @b\ cryptx\_hmac\_ctx.}}
\DoxyCodeLine{00172\ \textcolor{comment}{\ *\ \ @note\ Uses\ 516\ bytes\ of\ fastMem\ starting\ at\ 0xE30800.}}
\DoxyCodeLine{00173\ \textcolor{comment}{\ *\ \ @warning\ Calling\ this\ on\ a\ context\ that\ has\ not\ been\ initialized\ may\ have}}
\DoxyCodeLine{00174\ \textcolor{comment}{\ *\ \ unpredictable\ results.}}
\DoxyCodeLine{00175\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00176\ \textcolor{keywordtype}{void}\ cryptx\_hmac\_digest(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__hmac__ctx}{cryptx\_hmac\_ctx}}*\ context,\ \textcolor{keywordtype}{void}*\ output);}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00180\ \textcolor{comment}{//\ \ PASSWORD-\/BASED\ KEY\ DERIVATION\ FUNCTION\ 2\ (PBKDF2)}}
\DoxyCodeLine{00181\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00184\ \textcolor{comment}{}\textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00185\ \textcolor{comment}{\ *\ @brief\ Derives\ a\ key\ from\ a\ password,\ salt,\ and\ round\ count.}}
\DoxyCodeLine{00186\ \textcolor{comment}{\ *\ @param[in]\ password\ \ Pointer\ to\ a\ string\ containing\ the\ password.}}
\DoxyCodeLine{00187\ \textcolor{comment}{\ *\ @param[in]\ passlen\ \ \ Byte\ length\ of\ the\ password.}}
\DoxyCodeLine{00188\ \textcolor{comment}{\ *\ @param[in]\ salt\ \ \ A\ psuedo-\/random\ string\ to\ use\ in\ each\ round\ of\ key\ derivation.}}
\DoxyCodeLine{00189\ \textcolor{comment}{\ *\ @param[in]\ saltlen\ \ \ Byte\ length\ of\ the\ salt.}}
\DoxyCodeLine{00190\ \textcolor{comment}{\ *\ @param[in]\ rounds\ \ \ \ The\ number\ of\ times\ to\ iterate\ the\ HMAC\ function\ per\ block\ of\ @b\ keylen.}}
\DoxyCodeLine{00191\ \textcolor{comment}{\ *\ @param[out]\ key\ \ \ \ \ \ Pointer\ to\ buffer\ to\ write\ key\ to.}}
\DoxyCodeLine{00192\ \textcolor{comment}{\ *\ @param[in]\ keylen\ \ \ \ Length\ of\ @b\ key\ to\ generate.}}
\DoxyCodeLine{00193\ \textcolor{comment}{\ *\ @param[in]\ hash\_alg\ \ The\ numeric\ ID\ of\ the\ hashing\ algorithm\ to\ use.\ See\ @b\ cryptx\_hash\_algorithms.}}
\DoxyCodeLine{00194\ \textcolor{comment}{\ *\ @note\ NIST\ recommends\ a\ salt\ of\ at\ least\ 128\ bits\ (16\ bytes).}}
\DoxyCodeLine{00195\ \textcolor{comment}{\ *\ @note\ @b\ rounds\ is\ used\ to\ increase\ the\ cost\ (computational\ time)\ of\ generating\ a\ key.\ What\ makes\ password-\/}}
\DoxyCodeLine{00196\ \textcolor{comment}{\ *\ hashing\ algorithms\ secure\ is\ the\ time\ needed\ to\ generate\ a\ rainbow\ table\ attack\ against\ it.\ More\ rounds\ means}}
\DoxyCodeLine{00197\ \textcolor{comment}{\ *\ a\ more\ secure\ key,\ but\ more\ time\ spent\ generating\ it.\ Current\ cryptography\ standards\ recommend\ thousands\ of}}
\DoxyCodeLine{00198\ \textcolor{comment}{\ *\ rounds\ but\ that\ may\ not\ be\ feasible\ on\ the\ CE.}}
\DoxyCodeLine{00199\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00200\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{cryptx_8h_a428a5da208ae3b55b73f4e05242148e8}{cryptx\_hmac\_pbkdf2}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ password,}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ passlen,}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ salt,}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ saltlen,}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t*\ key,}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ keylen,}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ rounds,}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ hash\_alg);}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00211\ \textcolor{comment}{//\ \ DIGEST\ OPERATIONS}}
\DoxyCodeLine{00212\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00215\ \textcolor{comment}{}\textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00216\ \textcolor{comment}{\ *\ @brief\ Convert\ a\ digest\ to\ its\ hexstring\ representation.}}
\DoxyCodeLine{00217\ \textcolor{comment}{\ *\ @param[in]\ digest\ \ \ \ Pointer\ to\ a\ buffer\ or\ digest.}}
\DoxyCodeLine{00218\ \textcolor{comment}{\ *\ @param[in]\ len\ \ \ \ \ \ \ Byte\ length\ of\ @b\ digest.}}
\DoxyCodeLine{00219\ \textcolor{comment}{\ *\ @param[out]\ hexstr\ \ \ Buffer\ to\ write\ the\ output\ hex\ string\ to.}}
\DoxyCodeLine{00220\ \textcolor{comment}{\ *\ @note\ @b\ hexstr\ must\ be\ at\ least\ twice\ @b\ len\ +1\ bytes\ large.}}
\DoxyCodeLine{00221\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00222\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{cryptx_8h_aa25931fdaf401a4fddf0023e272278f7}{cryptx\_digest\_tostring}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ digest,\ \textcolor{keywordtype}{size\_t}\ len,\ uint8\_t*\ hexstr);}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00225\ \textcolor{comment}{\ *\ @brief\ Compare\ two\ digests\ or\ buffers.}}
\DoxyCodeLine{00226\ \textcolor{comment}{\ *\ @param[in]\ digest1\ \ \ Pointer\ to\ first\ buffer\ to\ compare.}}
\DoxyCodeLine{00227\ \textcolor{comment}{\ *\ @param[in]\ digest2\ \ \ Pointer\ to\ second\ buffer\ to\ compare.}}
\DoxyCodeLine{00228\ \textcolor{comment}{\ *\ @param[in]\ len\ \ \ \ \ \ \ Number\ of\ bytes\ to\ compare.}}
\DoxyCodeLine{00229\ \textcolor{comment}{\ *\ @return\ @b\ true\ if\ the\ buffers\ are\ equal,\ @b\ false\ if\ not\ equal.}}
\DoxyCodeLine{00230\ \textcolor{comment}{\ *\ @note\ This\ is\ a\ constant-\/time\ implementation.}}
\DoxyCodeLine{00231\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00232\ \textcolor{keywordtype}{bool}\ cryptx\_digest\_compare(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ digest1,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ digest2,\ \textcolor{keywordtype}{size\_t}\ len);}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00236\ \textcolor{comment}{//\ \ CRYPTOGRAPHICALLY-\/SECURE\ RANDOM\ NUMBER\ GENERATION}}
\DoxyCodeLine{00237\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00240\ \textcolor{comment}{}\textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00241\ \textcolor{comment}{\ *\ @brief\ Initializes\ the\ (HW)RNG.}}
\DoxyCodeLine{00242\ \textcolor{comment}{\ *\ @returns\ @b\ true\ on\ success,\ @b\ false\ on\ failure.}}
\DoxyCodeLine{00243\ \textcolor{comment}{\ *\ @note\ If\ you\ forget\ to\ call\ this\ function,\ utilizing\ the\ RNG's\ other\ functions\ will\ self-\/initialize\ the\ RNG.}}
\DoxyCodeLine{00244\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00245\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{cryptx_8h_aa4599a28ff439f7a21dbb0ce5772fa78}{cryptx\_csrand\_init}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00248\ \textcolor{comment}{\ *\ @brief\ Returns\ a\ securely\ psuedo-\/random\ 32-\/bit\ integer}}
\DoxyCodeLine{00249\ \textcolor{comment}{\ *\ @returns\ A\ securely\ psuedo-\/random\ 32-\/bit\ integer.}}
\DoxyCodeLine{00250\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00251\ uint32\_t\ cryptx\_csrand\_get(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00254\ \textcolor{comment}{\ *\ @brief\ Fills\ a\ buffer\ with\ securely\ pseduo-\/random\ bytes}}
\DoxyCodeLine{00255\ \textcolor{comment}{\ *\ @param[in]\ buffer\ \ \ \ Pointer\ to\ a\ buffer\ to\ fill\ with\ random\ bytes.}}
\DoxyCodeLine{00256\ \textcolor{comment}{\ *\ @param[in]\ size\ \ \ \ \ \ Size\ of\ the\ buffer\ to\ fill.}}
\DoxyCodeLine{00257\ \textcolor{comment}{\ *\ @returns\ @b\ true\ on\ success,\ @b\ false\ on\ failure.}}
\DoxyCodeLine{00258\ \textcolor{comment}{\ *\ @returns\ @b\ buffer\ filled\ to\ size.}}
\DoxyCodeLine{00259\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00260\ \textcolor{keywordtype}{bool}\ cryptx\_csrand\_fill(\textcolor{keywordtype}{void}*\ buffer,\ \textcolor{keywordtype}{size\_t}\ size);}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00264\ \textcolor{comment}{//\ \ ADVANCED\ ENCRYPTION\ STANDARD\ (AES)\ ENCRYPTION}}
\DoxyCodeLine{00265\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00268\ \textcolor{comment}{}\textcolor{keyword}{struct\ }\mbox{\hyperlink{structcryptx__aes__ctx}{cryptx\_aes\_ctx}}\ \{}
\DoxyCodeLine{00269\ \ \ \ \ uint24\_t\ \mbox{\hyperlink{structcryptx__aes__ctx_a7b2aea1f1f8c40516832e1b51de6f059}{keysize}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00270\ \ \ \ \ uint32\_t\ \mbox{\hyperlink{structcryptx__aes__ctx_ad7abad71532100be2c688e11e6dedf6d}{round\_keys}}[60];\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00271\ \ \ \ \ uint8\_t\ \mbox{\hyperlink{structcryptx__aes__ctx_a71f1c71840080ed09b27da0332db0944}{iv}}[16];\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00272\ \ \ \ \ uint8\_t\ \mbox{\hyperlink{structcryptx__aes__ctx_a963065a29ef08538b1ee614196baa38f}{ciphermode}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00273\ \ \ \ \ uint8\_t\ \mbox{\hyperlink{structcryptx__aes__ctx_a7638d6269b5072f4fe3db606d4e46881}{op\_assoc}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00274\ \ \ \ \ \mbox{\hyperlink{unioncryptx__aes__private__h}{cryptx\_aes\_private\_h}}\ \mbox{\hyperlink{structcryptx__aes__ctx_a80f93c50e66994a5d992601fe2bc90d5}{metadata}};\ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00275\ \};}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{cryptx_8h_a59334db45c5435de6ded4492dec34735}{cryptx\_aes\_cipher\_modes}}\ \{}
\DoxyCodeLine{00278\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a59334db45c5435de6ded4492dec34735ad21a3698b98b7368b14ec3d48314a132}{AES\_MODE\_CBC}},\ \ \ \ \ \ \ }
\DoxyCodeLine{00279\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a59334db45c5435de6ded4492dec34735a5ecd63cd0bd97d46f273461b6550cb8e}{AES\_MODE\_CTR}},\ \ \ \ \ \ \ }
\DoxyCodeLine{00280\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a59334db45c5435de6ded4492dec34735aa41ebb36bc19b64d64ff6b7fc0d5e5df}{AES\_MODE\_GCM}}\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00281\ \};}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{cryptx_8h_a66b61f98ab7705ff93bde98685ff3433}{cryptx\_aes\_padding\_schemes}}\ \{}
\DoxyCodeLine{00284\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a66b61f98ab7705ff93bde98685ff3433a673ae2fee0bfe0a962717b3f673b9b7c}{PAD\_PKCS7}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00285\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a66b61f98ab7705ff93bde98685ff3433a322c11c9058ef67073a3ff9bdcb9f759}{PAD\_DEFAULT}}\ =\ \mbox{\hyperlink{cryptx_8h_a66b61f98ab7705ff93bde98685ff3433a673ae2fee0bfe0a962717b3f673b9b7c}{PAD\_PKCS7}},\ \ \ \ }
\DoxyCodeLine{00288\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a66b61f98ab7705ff93bde98685ff3433a7566d9371110a1a24db62b145c901ad8}{PAD\_ISO2}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00289\ \};}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00291\ \textcolor{preprocessor}{\#define\ CRYPTX\_AES128\_KEYLEN\ \ \ \ 16\ \ \ \ \ \ }}
\DoxyCodeLine{00292\ \textcolor{preprocessor}{\#define\ CRYPTX\_AES192\_KEYLEN\ \ \ \ 24\ \ \ \ \ \ }}
\DoxyCodeLine{00293\ \textcolor{preprocessor}{\#define\ CRYPTX\_AES256\_KEYLEN\ \ \ \ 32\ \ \ \ \ \ }}
\DoxyCodeLine{00295\ \textcolor{preprocessor}{\#define\ CRYPTX\_AES\_BLOCK\_SIZE\ \ \ 16\ \ \ \ \ \ }}
\DoxyCodeLine{00296\ \textcolor{preprocessor}{\#define\ CRYPTX\_AES\_IV\_SIZE\ \ CRYPTX\_AES\_BLOCK\_SIZE\ \ \ }}
\DoxyCodeLine{00297\ \textcolor{preprocessor}{\#define\ CRYPTX\_AES\_AUTHTAG\_SIZE\ CRYPTX\_AES\_BLOCK\_SIZE\ \ \ }}
\DoxyCodeLine{00300\ \textcolor{preprocessor}{\#define\ CRYPTX\_AES\_CBC\_FLAGS(padding\_mode)\ \(\backslash\)}}
\DoxyCodeLine{00301\ \textcolor{preprocessor}{\ \ \ \ ((padding\_mode)<<2)\ |\ AES\_MODE\_CBC}}
\DoxyCodeLine{00302\ }
\DoxyCodeLine{00304\ \textcolor{preprocessor}{\#define\ CRYPTX\_AES\_CTR\_FLAGS(nonce\_len,\ counter\_len)\ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00305\ \textcolor{preprocessor}{\ \ \ \ ((0x0f\ \&\ (counter\_len))<<8)\ |\ ((0x0f\ \&\ (nonce\_len))<<4)\ |\ AES\_MODE\_CTR}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00308\ \textcolor{preprocessor}{\#define\ CRYPTX\_AES\_GCM\_FLAGS\ \ \ \ AES\_MODE\_GCM}}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00311\ \textcolor{preprocessor}{\#define\ cryptx\_aes\_get\_ciphertext\_len(len)\ \(\backslash\)}}
\DoxyCodeLine{00312\ \textcolor{preprocessor}{((((len)\%CRYPTX\_AES\_BLOCK\_SIZE)==0)\ ?\ (len)\ +\ CRYPTX\_AES\_BLOCK\_SIZE\ :\ (((len)>>4)\ +\ 1)<<4)}}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00315\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_aeb2e64abcc4317e3143fb820f21c3bfdaacf07636102724d2a7913911b0cf74b2}{AES\_OK}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00316\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_aeb2e64abcc4317e3143fb820f21c3bfda6d39b280aea9d8d62d126eef05d271db}{AES\_INVALID\_ARG}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00317\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_aeb2e64abcc4317e3143fb820f21c3bfdaae5e9a591aeda666b0e425d9a05834e3}{AES\_INVALID\_MSG}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00318\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_aeb2e64abcc4317e3143fb820f21c3bfdad2b49ffeabf14aaf47db3d1bad18f84e}{AES\_INVALID\_CIPHERMODE}},\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00319\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_aeb2e64abcc4317e3143fb820f21c3bfda47bbd593fc3bdb7758a790bab86b41d9}{AES\_INVALID\_PADDINGMODE}},\ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00320\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_aeb2e64abcc4317e3143fb820f21c3bfdaba928751c773ffa0287e47e1f86eae8b}{AES\_INVALID\_CIPHERTEXT}},\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00321\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_aeb2e64abcc4317e3143fb820f21c3bfda95a9dcbf64347e3c6f2c50d05e8937f5}{AES\_INVALID\_OPERATION}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00322\ \}\ \mbox{\hyperlink{cryptx_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\_error\_t}};}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00324\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00325\ \textcolor{comment}{\ *\ @brief\ Initializes\ a\ stateful\ AES\ cipher\ context\ to\ be\ used\ for\ encryption\ or\ decryption.}}
\DoxyCodeLine{00326\ \textcolor{comment}{\ *\ @param[in]\ context\ \ \ Pointer\ to\ an\ AES\ cipher\ context\ to\ initialize.}}
\DoxyCodeLine{00327\ \textcolor{comment}{\ *\ @param[in]\ key\ \ \ Pointer\ to\ an\ 128,\ 192,\ or\ 256\ bit\ key\ to\ load\ into\ the\ AES\ context.}}
\DoxyCodeLine{00328\ \textcolor{comment}{\ *\ @param[in]\ keylen\ \ \ \ The\ size,\ in\ bytes,\ of\ the\ @b\ key\ to\ load.}}
\DoxyCodeLine{00329\ \textcolor{comment}{\ *\ @param[in]\ iv\ \ \ \ Pointer\ to\ \ Initialization\ vector,\ a\ buffer\ equal\ to\ the\ block\ size\ filled\ with\ random\ bytes.}}
\DoxyCodeLine{00330\ \textcolor{comment}{\ *\ @param[in]\ ivlen\ Length\ of\ the\ initalization\ vector.\ Capped\ at\ 16\ bytes.\ Certain\ cipher\ modes\ have\ different\ recommendations.}}
\DoxyCodeLine{00331\ \textcolor{comment}{\ *\ @param[in]\ flags\ A\ series\ of\ flags\ to\ configure\ the\ AES\ context\ with.}}
\DoxyCodeLine{00332\ \textcolor{comment}{\ *\ \ \ \ \ \ \ \ \ \ \ \ \ \ Use\ the\ provided\ @b\ CRYPTX\_AES\_CTR\_FLAGS,\ @b\ CRYPTX\_AES\_CBC\_FLAGS,\ or\ @b\ CRYPTX\_AES\_GCM\_FLAGS\ to\ pass\ flags.}}
\DoxyCodeLine{00333\ \textcolor{comment}{\ *\ @returns\ An\ @b\ aes\_error\_t\ indicating\ the\ status\ of\ the\ AES\ operation.}}
\DoxyCodeLine{00334\ \textcolor{comment}{\ *\ @note\ Contexts\ are\ not\ bidirectional\ due\ to\ being\ stateful.\ If\ you\ need\ to\ process\ both\ encryption\ and\ decryption,}}
\DoxyCodeLine{00335\ \textcolor{comment}{\ *\ initialize\ seperate\ contexts\ for\ encryption\ and\ decryption.\ Both\ contexts\ will\ use\ the\ same\ key,\ but\ different\ initialization\ vectors.}}
\DoxyCodeLine{00336\ \textcolor{comment}{\ *\ @warning\ It\ is\ recommended\ to\ cycle\ your\ key\ after\ encrypting\ 2\string^64\ blocks\ of\ data\ with\ the\ same\ key.}}
\DoxyCodeLine{00337\ \textcolor{comment}{\ *\ @warning\ Do\ not\ manually\ edit\ the\ @b\ ctx.mode\ field\ of\ the\ context\ structure.}}
\DoxyCodeLine{00338\ \textcolor{comment}{\ *\ This\ will\ break\ the\ cipher\ configuration.\ If\ you\ want\ to\ change\ cipher\ modes,\ do\ so\ by\ calling\ @b\ aes\_init\ again.}}
\DoxyCodeLine{00339\ \textcolor{comment}{\ *\ @warning\ AES-\/CBC\ and\ CTR\ modes\ ensure\ confidentiality\ but\ do\ not\ provide\ message\ integrity\ verification.}}
\DoxyCodeLine{00340\ \textcolor{comment}{\ *\ If\ you\ need\ a\ truly\ secure\ construction,\ use\ GCM\ mode\ or\ append\ a\ keyed\ hash\ (HMAC)\ to\ the\ encrypted\ message..}}
\DoxyCodeLine{00341\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00342\ \mbox{\hyperlink{cryptx_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\_error\_t}}\ cryptx\_aes\_init(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__aes__ctx}{cryptx\_aes\_ctx}}*\ context,}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ key,}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ keylen,}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ iv,}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ivlen,}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint24\_t\ flags);}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00350\ \textcolor{comment}{\ *\ @brief\ Performs\ a\ stateful\ AES\ encryption\ of\ an\ arbitrary\ length\ of\ data.}}
\DoxyCodeLine{00351\ \textcolor{comment}{\ *\ @param[in]\ context\ \ \ Pointer\ to\ an\ AES\ cipher\ context.}}
\DoxyCodeLine{00352\ \textcolor{comment}{\ *\ @param[in]\ plaintext\ Pointer\ to\ data\ to\ encrypt.}}
\DoxyCodeLine{00353\ \textcolor{comment}{\ *\ @param[in]\ len\ \ \ \ \ \ \ Length\ of\ data\ at\ @b\ plaintext\ to\ encrypt.}}
\DoxyCodeLine{00354\ \textcolor{comment}{\ *\ @param[out]\ ciphertext\ \ \ Pointer\ to\ buffer\ to\ write\ encrypted\ data\ to.}}
\DoxyCodeLine{00355\ \textcolor{comment}{\ *\ @returns\ An\ @b\ aes\_error\_t\ indicating\ the\ status\ of\ the\ AES\ operation.}}
\DoxyCodeLine{00356\ \textcolor{comment}{\ *\ @note\ @b\ ciphertext\ should\ large\ enough\ to\ hold\ the\ encrypted\ message.}}
\DoxyCodeLine{00357\ \textcolor{comment}{\ *\ \ \ \ \ \ \ \ \ \ For\ CBC\ mode,\ this\ is\ the\ smallest\ multiple\ of\ the\ blocksize\ that\ will\ hold\ the\ plaintext.}}
\DoxyCodeLine{00358\ \textcolor{comment}{\ *\ \ \ \ \ \ \ \ \ \ See\ the\ @b\ CRYPTX\_AES\_CIPHERTEXT\_LEN\ macro.}}
\DoxyCodeLine{00359\ \textcolor{comment}{\ *\ \ \ \ \ \ \ \ \ \ For\ CTR\ and\ GCM\ modes,\ this\ is\ the\ same\ size\ as\ the\ plaintext.}}
\DoxyCodeLine{00360\ \textcolor{comment}{\ *\ @note\ @b\ plaintext\ and\ @b\ ciphertext\ are\ aliasable.}}
\DoxyCodeLine{00361\ \textcolor{comment}{\ *\ @note\ Encrypt\ is\ streamable,\ such\ that\ encrypt(msg1)\ +\ encrypt(msg2)\ is\ functionally\ identical\ to\ encrypt(msg1+msg2)}}
\DoxyCodeLine{00362\ \textcolor{comment}{\ *\ with\ the\ exception\ of\ intervening\ padding\ in\ CBC\ mode.}}
\DoxyCodeLine{00363\ \textcolor{comment}{\ *\ @note\ Once\ a\ \ context\ is\ used\ for\ encryption,\ it\ cannot\ be\ used\ for\ decryption.}}
\DoxyCodeLine{00364\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00365\ \mbox{\hyperlink{cryptx_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\_error\_t}}\ cryptx\_aes\_encrypt(\textcolor{keyword}{const}\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__aes__ctx}{cryptx\_aes\_ctx}}*\ context,}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ plaintext,}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ len,}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}*\ ciphertext);}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00371\ \textcolor{comment}{\ *\ @brief\ Performs\ a\ stateful\ AES\ decryption\ of\ an\ arbitrary\ length\ of\ data.}}
\DoxyCodeLine{00372\ \textcolor{comment}{\ *\ @param[in]\ context\ \ \ \ \ \ \ Pointer\ to\ AES\ cipher\ context.}}
\DoxyCodeLine{00373\ \textcolor{comment}{\ *\ @param[in]\ ciphertext\ \ \ \ Pointer\ to\ data\ to\ decrypt.}}
\DoxyCodeLine{00374\ \textcolor{comment}{\ *\ @param[in]\ len\ \ \ \ \ \ \ Length\ of\ data\ at\ @b\ ciphertext\ to\ decrypt.}}
\DoxyCodeLine{00375\ \textcolor{comment}{\ *\ @param[out]\ plaintext\ \ \ \ Pointer\ to\ buffer\ to\ write\ decryped\ data\ to.}}
\DoxyCodeLine{00376\ \textcolor{comment}{\ *\ @returns\ An\ @b\ aes\_error\_t\ indicating\ the\ status\ of\ the\ AES\ operation.}}
\DoxyCodeLine{00377\ \textcolor{comment}{\ *\ @note\ @b\ plaintext\ and\ @b\ ciphertext\ are\ aliasable.}}
\DoxyCodeLine{00378\ \textcolor{comment}{\ *\ @note\ Decrypt\ is\ streamable,\ such\ that\ decrypt(msg1)\ +\ decrypt(msg2)\ is\ functionally\ identical\ to\ decrypt(msg1+msg2)}}
\DoxyCodeLine{00379\ \textcolor{comment}{\ *\ with\ the\ exception\ of\ intervening\ padding\ in\ CBC\ mode.}}
\DoxyCodeLine{00380\ \textcolor{comment}{\ *\ @note\ Once\ a\ context\ is\ used\ for\ decryption,\ it\ cannot\ be\ used\ for\ encryption.}}
\DoxyCodeLine{00381\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00382\ \mbox{\hyperlink{cryptx_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\_error\_t}}\ cryptx\_aes\_decrypt(\textcolor{keyword}{const}\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__aes__ctx}{cryptx\_aes\_ctx}}*\ context,}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ ciphertext,}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ len,}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}*\ plaintext);}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00388\ \textcolor{comment}{\ *\ @brief\ Updates\ the\ cipher\ context\ for\ given\ AAD\ (Additional\ Authenticated\ Data).}}
\DoxyCodeLine{00389\ \textcolor{comment}{\ *\ AAD\ is\ data\ that\ is\ only\ authenticated,\ not\ encrypted.}}
\DoxyCodeLine{00390\ \textcolor{comment}{\ *\ @param[in]\ context\ \ \ Pointer\ to\ an\ AES\ context.}}
\DoxyCodeLine{00391\ \textcolor{comment}{\ *\ @param[in]\ aad\ \ \ \ \ \ \ Pointer\ to\ additional\ authenticated\ data\ segment.}}
\DoxyCodeLine{00392\ \textcolor{comment}{\ *\ @param[in]\ aad\_len\ \ \ Length\ of\ additional\ data\ segment.}}
\DoxyCodeLine{00393\ \textcolor{comment}{\ *\ @returns\ An\ @b\ aes\_error\_t\ indicating\ the\ status\ of\ the\ AES\ operation.}}
\DoxyCodeLine{00394\ \textcolor{comment}{\ *\ @note\ This\ function\ is\ only\ compatible\ with\ AES-\/GCM\ cipher\ mode.\ Attempting\ to}}
\DoxyCodeLine{00395\ \textcolor{comment}{\ *\ use\ this\ function\ for\ any\ other\ cipher\ mode\ will\ return\ @b\ AES\_INVALID\_CIPHERMODE.}}
\DoxyCodeLine{00396\ \textcolor{comment}{\ *\ @note\ This\ function\ can\ only\ be\ called\ between\ the\ call\ to\ @b\ cryptx\_aes\_init\ and\ the\ first\ call}}
\DoxyCodeLine{00397\ \textcolor{comment}{\ *\ to\ @b\ cryptx\_aes\_encrypt\ or\ @b\ cryptx\_aes\_decrypt.\ Once\ encryption\ or\ decryption\ starts,\ you\ can}}
\DoxyCodeLine{00398\ \textcolor{comment}{\ *\ no\ longer\ update\ AAD.}}
\DoxyCodeLine{00399\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00400\ \mbox{\hyperlink{cryptx_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\_error\_t}}\ cryptx\_aes\_update\_aad(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__aes__ctx}{cryptx\_aes\_ctx}}*\ context,}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ aad,\ \textcolor{keywordtype}{size\_t}\ aad\_len);}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00404\ \textcolor{comment}{\ *\ @brief\ Returns\ the\ current\ authentication\ tag\ for\ data\ parsed\ so\ far.}}
\DoxyCodeLine{00405\ \textcolor{comment}{\ *\ @param[in]\ context\ \ \ Pointer\ to\ an\ AES\ context}}
\DoxyCodeLine{00406\ \textcolor{comment}{\ *\ @param[out]\ digest\ \ \ Pointer\ to\ a\ buffer\ to\ output\ digest\ to.\ Must\ be\ at\ least\ 16\ bytes\ large.}}
\DoxyCodeLine{00407\ \textcolor{comment}{\ *\ @returns\ An\ @b\ aes\_error\_t\ indicating\ the\ status\ of\ the\ AES\ operation.}}
\DoxyCodeLine{00408\ \textcolor{comment}{\ *\ @note\ This\ function\ is\ only\ compatible\ with\ AES-\/GCM\ cipher\ mode.\ Attempting\ to\ call\ it\ for\ any}}
\DoxyCodeLine{00409\ \textcolor{comment}{\ *\ other\ cipher\ mode\ will\ return\ @b\ AES\_INVALID\_CIPHERMODE.}}
\DoxyCodeLine{00410\ \textcolor{comment}{\ *\ @note\ Calling\ this\ function\ terminates\ your\ use\ of\ the\ current\ AES\ context.\ This\ is\ because}}
\DoxyCodeLine{00411\ \textcolor{comment}{\ *\ reuse\ of\ the\ IV\ buffer\ can\ leak\ the\ hkey\ used\ for\ authentication.\ The\ next\ stream\ may\ use\ the\ same}}
\DoxyCodeLine{00412\ \textcolor{comment}{\ *\ encryption\ key\ but\ should\ have\ a\ unique\ IV.}}
\DoxyCodeLine{00413\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00414\ \mbox{\hyperlink{cryptx_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\_error\_t}}\ cryptx\_aes\_digest(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__aes__ctx}{cryptx\_aes\_ctx}}*\ context,\ uint8\_t\ *digest);}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00416\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00417\ \textcolor{comment}{\ *\ @brief\ Parses\ the\ specified\ AAD\ and\ ciphertext\ and\ then\ compares\ the\ output\ auth\ tag}}
\DoxyCodeLine{00418\ \textcolor{comment}{\ *\ to\ an\ expected\ auth\ tag.}}
\DoxyCodeLine{00419\ \textcolor{comment}{\ *\ @param[in]\ context\ \ \ Pointer\ to\ an\ AES\ context.}}
\DoxyCodeLine{00420\ \textcolor{comment}{\ *\ @param[in]\ aad\ \ \ \ \ \ \ Pointer\ to\ associated\ data\ to\ authenticate.}}
\DoxyCodeLine{00421\ \textcolor{comment}{\ *\ @param[in]\ aad\_len\ \ \ Length\ of\ associated\ data\ to\ authenticate.}}
\DoxyCodeLine{00422\ \textcolor{comment}{\ *\ @param[in]\ ciphertext\ \ \ \ Pointer\ to\ ciphertext\ to\ authenticate.}}
\DoxyCodeLine{00423\ \textcolor{comment}{\ *\ @param[in]\ ciphertext\_len\ \ \ \ Length\ of\ ciphertext\ to\ authenticate.}}
\DoxyCodeLine{00424\ \textcolor{comment}{\ *\ @param[in]\ tag\ \ \ \ \ \ \ Pointer\ to\ expected\ auth\ tag\ to\ validate\ against.}}
\DoxyCodeLine{00425\ \textcolor{comment}{\ *\ @returns\ TRUE\ if\ authentication\ \ tag\ matches\ expected,\ FALSE\ otherwise.}}
\DoxyCodeLine{00426\ \textcolor{comment}{\ *\ @note\ operates\ on\ a\ dummy\ copy\ of\ @b\ *context\ to\ avoid\ nuking\ the\ active\ copy}}
\DoxyCodeLine{00427\ \textcolor{comment}{\ *\ @note\ If\ this\ function\ returns\ FALSE,\ do\ not\ decrypt\ the\ message.}}
\DoxyCodeLine{00428\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \textcolor{keywordtype}{bool}\ cryptx\_aes\_verify(\textcolor{keyword}{const}\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__aes__ctx}{cryptx\_aes\_ctx}}*\ context,}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ aad,\ \textcolor{keywordtype}{size\_t}\ aad\_len,}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ ciphertext,\ \textcolor{keywordtype}{size\_t}\ ciphertext\_len,}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ *tag);}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00436\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00437\ \textcolor{comment}{//\ \ RIVEST-\/SHAMIR-\/ADLEMAN\ (RSA)\ ENCRYPTION}}
\DoxyCodeLine{00438\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00441\ \textcolor{comment}{}\textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00442\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a0486449f609d0e485bad091a671d9294a2cafdb683e1870a33bcb821420626cae}{RSA\_OK}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00443\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a0486449f609d0e485bad091a671d9294aab9ab38286c4180a1aa9f6e8df42e5db}{RSA\_INVALID\_ARG}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00444\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a0486449f609d0e485bad091a671d9294aedeb18a96b96e292369abed5b2f0a271}{RSA\_INVALID\_MSG}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00445\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a0486449f609d0e485bad091a671d9294a843ec210de66176ef63e2d2b8ebdeb65}{RSA\_INVALID\_MODULUS}},\ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00446\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a0486449f609d0e485bad091a671d9294a43eadc89540121b902e02afabc7a7eb9}{RSA\_ENCODING\_ERROR}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00447\ \}\ \mbox{\hyperlink{cryptx_8h_a0486449f609d0e485bad091a671d9294}{rsa\_error\_t}};}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00450\ \textcolor{preprocessor}{\#define\ CRYPTX\_RSA\_MODULUS\_MAX\ \ \ \ \ \ 256}}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00452\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00453\ \textcolor{comment}{\ *\ @brief\ Encrypts\ a\ message\ using\ the\ given\ RSA\ public\ key.}}
\DoxyCodeLine{00454\ \textcolor{comment}{\ *\ @param[in]\ msg\ \ \ Pointer\ to\ a\ message\ to\ encrypt\ using\ RSA.}}
\DoxyCodeLine{00455\ \textcolor{comment}{\ *\ @param[in]\ msglen\ \ \ \ The\ byte\ length\ of\ the\ @b\ msg.}}
\DoxyCodeLine{00456\ \textcolor{comment}{\ *\ @param[in]\ pubkey\ \ \ \ Pointer\ to\ a\ public\ key\ to\ use\ for\ encryption.}}
\DoxyCodeLine{00457\ \textcolor{comment}{\ *\ @param[in]\ keylen\ \ \ \ The\ length\ of\ the\ public\ key\ (modulus)\ to\ encrypt\ with.}}
\DoxyCodeLine{00458\ \textcolor{comment}{\ *\ @param[out]\ ciphertext\ \ \ Pointer\ a\ buffer\ to\ write\ the\ ciphertext\ to.}}
\DoxyCodeLine{00459\ \textcolor{comment}{\ *\ @param[in]\ oaep\_hash\_alg\ The\ numeric\ ID\ of\ the\ hashing\ algorithm\ to\ use\ within\ OAEP\ encoding.}}
\DoxyCodeLine{00460\ \textcolor{comment}{\ *\ \ \ \ \ \ See\ @b\ cryptx\_hash\_algorithms.}}
\DoxyCodeLine{00461\ \textcolor{comment}{\ *\ @returns\ \ An\ @b\ rsa\_error\_t\ indicating\ the\ status\ of\ the\ RSA\ operation.}}
\DoxyCodeLine{00462\ \textcolor{comment}{\ *\ @note\ The\ size\ of\ @b\ ciphertext\ and\ @b\ keylen\ must\ be\ equal.}}
\DoxyCodeLine{00463\ \textcolor{comment}{\ *\ @note\ The\ @b\ msg\ will\ be\ encoded\ using\ OAEP\ before\ encryption.}}
\DoxyCodeLine{00464\ \textcolor{comment}{\ *\ @note\ msg\ and\ pubkey\ are\ both\ treated\ as\ byte\ arrays.}}
\DoxyCodeLine{00465\ \textcolor{comment}{\ *\ @note\ The\ public\ exponent\ is\ hardcoded\ to\ @b\ 65537.}}
\DoxyCodeLine{00466\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00467\ \mbox{\hyperlink{cryptx_8h_a0486449f609d0e485bad091a671d9294}{rsa\_error\_t}}\ cryptx\_rsa\_encrypt(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ msg,}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ msglen,}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ pubkey,}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ keylen,}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}*\ ciphertext,}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ oaep\_hash\_alg);}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00476\ \textcolor{comment}{//\ \ ELLIPTIC\ CURVE\ DIFFIE-\/HELLMAN\ (ECDH)\ ENCRYPTION}}
\DoxyCodeLine{00477\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00479\ \textcolor{comment}{}\textcolor{comment}{//\ Using\ curve\ SECT233k1}}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00482\ \textcolor{preprocessor}{\#define\ CRYPTX\_ECDH\_PRIVKEY\_LEN\ \ \ \ \ 30}}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00485\ \textcolor{preprocessor}{\#define\ CRYPTX\_ECDH\_PUBKEY\_LEN\ \ \ \ \ \ (CRYPTX\_ECDH\_PRIVKEY\_LEN<<1)}}
\DoxyCodeLine{00486\ \textcolor{preprocessor}{\#define\ CRYPTX\_ECDH\_SECRET\_LEN\ \ \ \ \ \ CRYPTX\_ECDH\_PUBKEY\_LEN}}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \textcolor{preprocessor}{\#define\ cryptx\_ecdh\_generate\_privkey(privkey)\ \ \ \(\backslash\)}}
\DoxyCodeLine{00489\ \textcolor{preprocessor}{\ \ \ \ cryptx\_csrand\_fill((privkey),\ (CRYPTX\_ECDH\_PRIVKEY\_LEN))}}
\DoxyCodeLine{00490\ }
\DoxyCodeLine{00491\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \_ecdh\_error\ \{}
\DoxyCodeLine{00492\ \ \ \ \ ECDH\_OK,}
\DoxyCodeLine{00493\ \ \ \ \ ECDH\_INVALID\_ARG,}
\DoxyCodeLine{00494\ \ \ \ \ ECDH\_PRIVKEY\_INVALID,}
\DoxyCodeLine{00495\ \ \ \ \ ECDH\_RPUBKEY\_INVALID}
\DoxyCodeLine{00496\ \}\ ecdh\_error\_t;}
\DoxyCodeLine{00497\ }
\DoxyCodeLine{00498\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00499\ \textcolor{comment}{\ *\ @brief\ Generates\ a\ public\ key\ from\ the\ private\ key\ and\ some\ base\ point\ G\ on\ curve.}}
\DoxyCodeLine{00500\ \textcolor{comment}{\ *\ @param[in]\ privkey\ \ \ Pointer\ to\ a\ randomized\ ECDH\ private\ key.}}
\DoxyCodeLine{00501\ \textcolor{comment}{\ *\ @param[out]\ pubkey\ \ \ Pointer\ to\ buffer\ to\ write\ public\ key.}}
\DoxyCodeLine{00502\ \textcolor{comment}{\ *\ @note\ Output\ public\ key\ is\ a\ point\ on\ the\ curve\ expressed\ as\ two\ 30-\/byte\ coordinates}}
\DoxyCodeLine{00503\ \textcolor{comment}{\ *\ encoded\ in\ little\ endian\ byte\ order\ and\ padded\ with\ zeros\ (if\ needed).\ You\ may\ have\ to}}
\DoxyCodeLine{00504\ \textcolor{comment}{\ *\ deserialize\ the\ key\ and\ then\ serialize\ it\ into\ a\ different\ format\ to\ use\ it\ with}}
\DoxyCodeLine{00505\ \textcolor{comment}{\ *\ some\ encryption\ libraries.}}
\DoxyCodeLine{00506\ \textcolor{comment}{\ *\ @note\ This\ function\ expects\ that\ @b\ privkey\ be\ filled\ with\ random\ bytes.\ Failure\ to\ do\ so}}
\DoxyCodeLine{00507\ \textcolor{comment}{\ *\ may\ cause\ unexpected\ behavior.\ See\ @b\ CRYPTX\_ECDH\_GENERATE\_PRIVKEY().}}
\DoxyCodeLine{00508\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00509\ ecdh\_error\_t\ cryptx\_ecdh\_publickey(\textcolor{keyword}{const}\ uint8\_t\ *privkey,\ uint8\_t\ *pubkey);}
\DoxyCodeLine{00510\ }
\DoxyCodeLine{00511\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00512\ \textcolor{comment}{\ *\ @brief\ Computes\ a\ secret\ from\ the\ private\ key\ and\ the\ remote\ public\ key.}}
\DoxyCodeLine{00513\ \textcolor{comment}{\ *\ @param[in]\ privkey\ \ \ Pointer\ to\ local\ private\ key.}}
\DoxyCodeLine{00514\ \textcolor{comment}{\ *\ @param[in]\ rpubkey\ \ \ Pointer\ to\ remote\ public\ key.}}
\DoxyCodeLine{00515\ \textcolor{comment}{\ *\ @param[out]\ secret\ \ \ Pointer\ to\ buffer\ to\ write\ shared\ secret\ to.}}
\DoxyCodeLine{00516\ \textcolor{comment}{\ *\ @note\ @b\ secret\ must\ be\ at\ least\ @b\ CRYPTX\_ECDH\_SECRET\_LEN\ bytes.}}
\DoxyCodeLine{00517\ \textcolor{comment}{\ *\ @note\ Output\ secret\ is\ a\ point\ on\ the\ curve\ expressed\ as\ two\ 30-\/byte\ coordinates}}
\DoxyCodeLine{00518\ \textcolor{comment}{\ *\ encoded\ in\ little\ endian\ byte\ order\ and\ padded\ with\ zeros\ if\ needed.\ You\ may\ have\ to}}
\DoxyCodeLine{00519\ \textcolor{comment}{\ *\ deserialize\ the\ secret\ and\ then\ serialize\ it\ into\ a\ different\ format\ for\ compatibility\ with}}
\DoxyCodeLine{00520\ \textcolor{comment}{\ *\ other\ encryption\ libraries.}}
\DoxyCodeLine{00521\ \textcolor{comment}{\ *\ @note\ It\ is\ generally\ not\ recommended\ to\ use\ the\ computed\ secret\ as\ an\ encryption\ key\ as\ is.}}
\DoxyCodeLine{00522\ \textcolor{comment}{\ *\ It\ is\ preferred\ to\ pass\ the\ secret\ to\ a\ KDF\ or\ a\ cryptographic\ primitive\ such\ as\ a\ hash\ function\ and\ use}}
\DoxyCodeLine{00523\ \textcolor{comment}{\ *\ that\ output\ as\ your\ symmetric\ key.}}
\DoxyCodeLine{00524\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00525\ ecdh\_error\_t\ cryptx\_ecdh\_secret(\textcolor{keyword}{const}\ uint8\_t\ *privkey,\ \textcolor{keyword}{const}\ uint8\_t\ *rpubkey,\ uint8\_t\ *secret);}
\DoxyCodeLine{00526\ }
\DoxyCodeLine{00527\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00528\ \textcolor{comment}{//\ \ ABSTRACT\ SYNTAX\ NOTATION\ ONE\ (ASN.1)\ DECODING}}
\DoxyCodeLine{00529\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00532\ \textcolor{comment}{}\textcolor{keyword}{enum}\ \mbox{\hyperlink{cryptx_8h_a689d38f1bafe5364a5f7737df5b304f5}{CRYPTX\_ASN1\_TAGS}}\ \{}
\DoxyCodeLine{00533\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a689d38f1bafe5364a5f7737df5b304f5a0b4ee1817dddda0e7bb95f8c9c5262cc}{ASN1\_RESVD}}\ =\ 0,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00534\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a689d38f1bafe5364a5f7737df5b304f5afcacc079274ffffd6f8f30005a478309}{ASN1\_BOOLEAN}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00535\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a689d38f1bafe5364a5f7737df5b304f5ace678073d12a09bd35a9d14ee843f4f6}{ASN1\_INTEGER}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00536\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a689d38f1bafe5364a5f7737df5b304f5a80cce3c21b5cf2a46abcf2d6559f16a2}{ASN1\_BITSTRING}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00537\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a689d38f1bafe5364a5f7737df5b304f5ad652362316e1126ce1f372ee9f42fdf7}{ASN1\_OCTETSTRING}},\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00538\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a689d38f1bafe5364a5f7737df5b304f5ab9aa4736a7a0bec12fda19d770381ade}{ASN1\_NULL}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00539\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a689d38f1bafe5364a5f7737df5b304f5ab4e5697bbcfa96959f724b475deb438d}{ASN1\_OBJECTID}},\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00540\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a689d38f1bafe5364a5f7737df5b304f5afa75f14a7646b0ee90575da2299c9303}{ASN1\_OBJECTDESC}},\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00541\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a689d38f1bafe5364a5f7737df5b304f5a2169eaf366165cd4dfe1aca66659935c}{ASN1\_INSTANCE}},\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00542\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a689d38f1bafe5364a5f7737df5b304f5ade199cbdfbec356bae58bc468797580a}{ASN1\_REAL}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00543\ \ \ \ \ ASN1\_ENUMERATED,}
\DoxyCodeLine{00544\ \ \ \ \ ASN1\_EMBEDDEDPDV,}
\DoxyCodeLine{00545\ \ \ \ \ ASN1\_UTF8STRING,}
\DoxyCodeLine{00546\ \ \ \ \ ASN1\_RELATIVEOID,}
\DoxyCodeLine{00547\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a689d38f1bafe5364a5f7737df5b304f5a472ab1907cf28338eff639b8b5ab667c}{ASN1\_SEQUENCE}}\ =\ 16,\ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00548\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a689d38f1bafe5364a5f7737df5b304f5aefff306acd391300face0a8080ad415e}{ASN1\_SET}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00549\ \ \ \ \ ASN1\_NUMERICSTRING,}
\DoxyCodeLine{00550\ \ \ \ \ ASN1\_PRINTABLESTRING,}
\DoxyCodeLine{00551\ \ \ \ \ ASN1\_TELETEXSTRING,}
\DoxyCodeLine{00552\ \ \ \ \ ASN1\_VIDEOTEXSTRING,}
\DoxyCodeLine{00553\ \ \ \ \ ASN1\_IA5STRING,}
\DoxyCodeLine{00554\ \ \ \ \ ASN1\_UTCTIME,}
\DoxyCodeLine{00555\ \ \ \ \ ASN1\_GENERALIZEDTIME,}
\DoxyCodeLine{00556\ \ \ \ \ ASN1\_GRAPHICSTRING,}
\DoxyCodeLine{00557\ \ \ \ \ ASN1\_VISIBLESTRING,}
\DoxyCodeLine{00558\ \ \ \ \ ASN1\_GENERALSTRING,}
\DoxyCodeLine{00559\ \ \ \ \ ASN1\_UNIVERSALSTRING,}
\DoxyCodeLine{00560\ \ \ \ \ ASN1\_CHARSTRING,}
\DoxyCodeLine{00561\ \ \ \ \ ASN1\_BMPSTRING}
\DoxyCodeLine{00562\ \};}
\DoxyCodeLine{00563\ }
\DoxyCodeLine{00564\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{cryptx_8h_a1450446b0fdb10702d0a1a792ac2c900}{CRYPTX\_ASN1\_CLASSES}}\ \{}
\DoxyCodeLine{00565\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a1450446b0fdb10702d0a1a792ac2c900a36845401ba730128d3078d9cd0730fe8}{ASN1\_UNIVERSAL}},\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00566\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a1450446b0fdb10702d0a1a792ac2c900a1c873115fb577a391d1af735307abc45}{ASN1\_APPLICATION}},\ \ \ \ \ \ \ }
\DoxyCodeLine{00567\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a1450446b0fdb10702d0a1a792ac2c900a0e4e8c83e4929fe69855de5c8c7a34d3}{ASN1\_CONTEXTSPEC}},\ \ \ \ \ \ \ }
\DoxyCodeLine{00568\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a1450446b0fdb10702d0a1a792ac2c900ac51c7440728bfe2d94426d0ca4f3d895}{ASN1\_PRIVATE}}\ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00569\ \};}
\DoxyCodeLine{00570\ }
\DoxyCodeLine{00571\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{cryptx_8h_af2211fe420abff08488c8f04de017080}{CRYPTX\_ASN1\_FORMS}}\ \{}
\DoxyCodeLine{00572\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_af2211fe420abff08488c8f04de017080a916350d579d4895b1f843289b60b4572}{ASN1\_PRIMITIVE}},\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00573\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_af2211fe420abff08488c8f04de017080ad03b2b41a6f3417a981a78ca887332e6}{ASN1\_CONSTRUCTED}},\ \ \ \ \ \ \ }
\DoxyCodeLine{00574\ \};}
\DoxyCodeLine{00575\ }
\DoxyCodeLine{00577\ \textcolor{preprocessor}{\#define\ cryptx\_asn1\_get\_tag(tag)\ \ \ \ \ \ \ \ ((tag)\ \&\ 0b111111)}}
\DoxyCodeLine{00579\ \textcolor{preprocessor}{\#define\ cryptx\_asn1\_get\_class(tag)\ \ \ \ \ \ (((tag)>>6)\ \&\ 0b11)}}
\DoxyCodeLine{00581\ \textcolor{preprocessor}{\#define\ cryptx\_asn1\_get\_form(tag)\ \ \ \ \ \ \ (((tag)>>5)\ \&\ 1)}}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00584\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a5a51cc1578f5502b17c42f16edb3fb33ae8a5623b62dab851b0dc76048afc0b4a}{ASN1\_OK}},\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00585\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a5a51cc1578f5502b17c42f16edb3fb33a434628c70562f3ab468d94e8eae7784d}{ASN1\_END\_OF\_FILE}},\ \ \ \ \ \ \ }
\DoxyCodeLine{00586\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a5a51cc1578f5502b17c42f16edb3fb33aa13d20ad819d43693d26c77b80fb4952}{ASN1\_INVALID\_ARG}},\ \ \ \ \ \ \ }
\DoxyCodeLine{00587\ \ \ \ \ \mbox{\hyperlink{cryptx_8h_a5a51cc1578f5502b17c42f16edb3fb33a0101185f2109f1ba75ea2c4833664474}{ASN1\_LEN\_OVERFLOW}},\ \ \ \ \ }
\DoxyCodeLine{00588\ \}\ \mbox{\hyperlink{cryptx_8h_a5a51cc1578f5502b17c42f16edb3fb33}{asn1\_error\_t}};}
\DoxyCodeLine{00589\ }
\DoxyCodeLine{00590\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00591\ \textcolor{comment}{\ *\ @brief\ Decodes\ the\ ASN.1\ data\ at\ the\ given\ address.\ Seeks\ to\ an\ element\ from\ the\ front\ of\ the\ data.}}
\DoxyCodeLine{00592\ \textcolor{comment}{\ *\ @param\ data\_start\ \ \ \ Pointer\ to\ a\ block\ of\ ASN.1-\/encoded\ data.}}
\DoxyCodeLine{00593\ \textcolor{comment}{\ *\ @param\ data\_len\ \ \ \ \ \ Length\ of\ ASN.1-\/encoded\ block.}}
\DoxyCodeLine{00594\ \textcolor{comment}{\ *\ @param\ seek\_to\ \ \ \ \ \ \ Number\ of\ ASN.1\ elements\ to\ skip\ before\ returning\ one.}}
\DoxyCodeLine{00595\ \textcolor{comment}{\ *\ @param\ element\_tag\ \ \ Masked\ tag\ value\ of\ the\ returned\ element.}}
\DoxyCodeLine{00596\ \textcolor{comment}{\ *\ @param\ element\_len\ \ \ Length\ of\ the\ returned\ element.}}
\DoxyCodeLine{00597\ \textcolor{comment}{\ *\ @param\ element\_data\ \ Pointer\ to\ the\ data\ of\ the\ returned\ element.}}
\DoxyCodeLine{00598\ \textcolor{comment}{\ *\ @returns\ \ \ \ \ \ \ \ \ \ \ \ \ An\ @b\ asn1\_error\_t\ indicating\ the\ status\ of\ the\ operation.}}
\DoxyCodeLine{00599\ \textcolor{comment}{\ *\ @note\ @b\ ASN1\_END\_OF\_FILE\ will\ be\ returned\ if\ @b\ seek\_to\ is\ invalid.}}
\DoxyCodeLine{00600\ \textcolor{comment}{\ *\ @note\ ASN.1\ is\ a\ tree\ structure.\ You\ can\ use\ the\ @b\ element\_data\ and\ @b\ element\_len\ parameters}}
\DoxyCodeLine{00601\ \textcolor{comment}{\ *\ returned\ by\ this\ function\ to\ iterate\ further\ up\ the\ tree.\ To\ see\ if\ an\ element\ is\ of\ a\ type\ for\ which\ this\ is}}
\DoxyCodeLine{00602\ \textcolor{comment}{\ *\ valid,\ check\ the\ return\ value\ of\ @b\ CRYPTX\_ASN1\_FORM(element\_tag).}}
\DoxyCodeLine{00603\ \textcolor{comment}{\ *\ @note\ NULL\ may\ be\ passed\ for\ @b\ element\_tag,\ @b\ element\_len,\ and/or\ @b\ element\_data\ if\ you\ do\ not}}
\DoxyCodeLine{00604\ \textcolor{comment}{\ *\ need\ to\ return\ that\ particular\ bit\ of\ information.}}
\DoxyCodeLine{00605\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00606\ \mbox{\hyperlink{cryptx_8h_a5a51cc1578f5502b17c42f16edb3fb33}{asn1\_error\_t}}\ cryptx\_asn1\_decode(}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *data\_start,}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ data\_len,}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ seek\_to,}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ *element\_tag,}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *element\_len,}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ **element\_data);}
\DoxyCodeLine{00613\ }
\DoxyCodeLine{00614\ }
\DoxyCodeLine{00615\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00616\ \textcolor{comment}{//\ \ BASE64\ DECODING}}
\DoxyCodeLine{00617\ \textcolor{comment}{//***************************************************************************************}}
\DoxyCodeLine{00620\ \textcolor{comment}{}\textcolor{preprocessor}{\#define\ cryptx\_base64\_get\_encoded\_len(len)\ \ \ \ \ \ ((len)\ *\ 4\ /\ 3)}}
\DoxyCodeLine{00621\ \textcolor{preprocessor}{\#define\ cryptx\_base64\_get\_decoded\_len(len)\ \ \ \ \ \ ((len)\ *\ 3\ /\ 4)}}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00623\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00624\ \textcolor{comment}{\ *\ @brief\ Converts\ an\ octet-\/encoded\ byte\ stream\ into\ a\ sextet-\/encoded\ byte\ stream.}}
\DoxyCodeLine{00625\ \textcolor{comment}{\ *\ @param\ dest\ Pointer\ to\ output\ sextet-\/encoded\ data\ stream.}}
\DoxyCodeLine{00626\ \textcolor{comment}{\ *\ @param\ src\ Pointer\ to\ input\ octet-\/encoded\ data\ stream.}}
\DoxyCodeLine{00627\ \textcolor{comment}{\ *\ @param\ len\ Length\ of\ octet-\/encoded\ data\ stream.}}
\DoxyCodeLine{00628\ \textcolor{comment}{\ *\ @note\ @b\ dest\ should\ be\ at\ least\ \ @b\ len\ \(\backslash\)*\ 4\ /\ 3\ bytes\ large.}}
\DoxyCodeLine{00629\ \textcolor{comment}{\ *\ @returns\ Length\ of\ output\ sextet.}}
\DoxyCodeLine{00630\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00631\ \textcolor{keywordtype}{size\_t}\ cryptx\_base64\_encode(\textcolor{keywordtype}{void}\ *dest,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *src,\ \textcolor{keywordtype}{size\_t}\ len);}
\DoxyCodeLine{00632\ }
\DoxyCodeLine{00633\ \textcolor{comment}{/******************************************************}}
\DoxyCodeLine{00634\ \textcolor{comment}{\ *\ @brief\ Converts\ a\ sextet-\/encoded\ byte\ stream\ into\ a\ octet-\/encoded\ byte\ stream.}}
\DoxyCodeLine{00635\ \textcolor{comment}{\ *\ @param\ dest\ Pointer\ to\ output\ octet-\/encoded\ data\ stream.}}
\DoxyCodeLine{00636\ \textcolor{comment}{\ *\ @param\ src\ Pointer\ to\ input\ sextet-\/encoded\ data\ stream.}}
\DoxyCodeLine{00637\ \textcolor{comment}{\ *\ @param\ len\ Length\ of\ sextet-\/encoded\ data\ stream.}}
\DoxyCodeLine{00638\ \textcolor{comment}{\ *\ @note\ @b\ dest\ should\ be\ at\ least\ @b\ len\ \(\backslash\)*\ 3\ /\ 4\ bytes\ large.}}
\DoxyCodeLine{00639\ \textcolor{comment}{\ *\ @returns\ Length\ of\ output\ octet.}}
\DoxyCodeLine{00640\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00641\ \textcolor{keywordtype}{size\_t}\ cryptx\_base64\_decode(\textcolor{keywordtype}{void}\ *dest,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *src,\ \textcolor{keywordtype}{size\_t}\ len);}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00644\ \textcolor{preprocessor}{\#ifdef\ CRYPTX\_ENABLE\_HAZMAT}}
\DoxyCodeLine{00645\ }
\DoxyCodeLine{00647\ \textcolor{keywordtype}{void}\ cryptx\_hazmat\_aes\_ecb\_encrypt(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *block\_in,}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *block\_out,}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__aes__ctx}{cryptx\_aes\_ctx}}*\ ks);}
\DoxyCodeLine{00650\ }
\DoxyCodeLine{00652\ \textcolor{keywordtype}{void}\ cryptx\_hazmat\_aes\_ecb\_decrypt(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *block\_in,}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *block\_out,}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structcryptx__aes__ctx}{cryptx\_aes\_ctx}}*\ ks);}
\DoxyCodeLine{00655\ }
\DoxyCodeLine{00657\ \textcolor{keywordtype}{bool}\ cryptx\_hazmat\_rsa\_oaep\_encode(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *plaintext,\ \ \ \ \ \ \ }
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ len,}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *encoded,\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ modulus\_len,}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t\ *auth,}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ hash\_alg);}
\DoxyCodeLine{00663\ }
\DoxyCodeLine{00665\ \textcolor{keywordtype}{bool}\ cryptx\_hazmat\_rsa\_oaep\_decode(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *encoded,\ \ \ \ \ }
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ len,}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *plaintext,\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t\ *auth,}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ hash\_alg);}
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00672\ \textcolor{keywordtype}{void}\ cryptx\_hazmat\_powmod(uint8\_t\ size,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ *restrict\ base,\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint24\_t\ exp,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t\ *restrict\ mod);\ \ \ }
\DoxyCodeLine{00677\ \textcolor{keyword}{struct\ }cryptx\_ecc\_point\ \{}
\DoxyCodeLine{00678\ \ \ \ \ uint8\_t\ x[GF2\_INTLEN];}
\DoxyCodeLine{00679\ \ \ \ \ uint8\_t\ y[GF2\_INTLEN];}
\DoxyCodeLine{00680\ \}}
\DoxyCodeLine{00681\ }
\DoxyCodeLine{00683\ \textcolor{keywordtype}{void}\ cryptx\_hazmat\_ecc\_point\_add(cryptx\_ecc\_point*\ p,\ cryptx\_ecc\_point*\ q);}
\DoxyCodeLine{00684\ }
\DoxyCodeLine{00686\ \textcolor{keywordtype}{void}\ cryptx\_hazmat\_ecc\_point\_double(cryptx\_ecc\_point*\ p);}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00689\ \textcolor{keywordtype}{void}\ cryptx\_hazmat\_ecc\_point\_mul\_scalar(cryptx\_ecc\_point*\ p,}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t*\ scalar,}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ scalar\_bit\_width);}
\DoxyCodeLine{00692\ }
\DoxyCodeLine{00693\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00694\ }
\DoxyCodeLine{00695\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

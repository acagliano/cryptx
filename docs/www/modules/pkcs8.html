<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PKCS#8 &mdash; CryptX  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/proof.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Secure Hashing" href="hash.html" />
    <link rel="prev" title="CryptX Library" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> CryptX
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Recommended Usage</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">PKCS#8</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#structures">Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#additional-info">Additional Info</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pkcs-8-specification">PKCS#8 Specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#object-identifier-reference">Object Identifier Reference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hash.html">Secure Hashing</a></li>
<li class="toctree-l1"><a class="reference internal" href="hmac.html">Hash-Based MAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="csrand.html">Secure Random Number Generator</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="bytes.html">Bytearray Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="aes.html">Advanced Encryption Standard</a></li>
<li class="toctree-l1"><a class="reference internal" href="rsa.html">RSA</a></li>
<li class="toctree-l1"><a class="reference internal" href="ec.html">Elliptic Curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="asn1.html">ASN.1/DER</a></li>
<li class="toctree-l1"><a class="reference internal" href="base64.html">Base64/PEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="hazmat.html">Hazardous Materials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../static/analysis.html">Analysis &amp; Overview</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CryptX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>PKCS#8</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="pkcs-8">
<span id="pkcs8"></span><h1>PKCS#8<a class="headerlink" href="#pkcs-8" title="Permalink to this headline"></a></h1>
<p style="color:red; font-weight:bold; font-size:120%;">Module under development. Check back for updates.</p><p style="background:rgba(176,196,222,.5); padding:10px; font-family:Arial; margin:20px 0;"><span style="font-weight:bold;">Module Functionality</span><br />Provides functions for the import of PKCS#8-encoded public and private keys that can be used with the RSA and EC modules of this library.</p><p>PKCS stands for <strong>Public Key Cryptography Standards</strong> and specification #8 provides general key encoding guidelines for various forms of public and private keys. Because the API of this library tends to work on raw data (rather than on key structures like other libraries do), this module provides a way to deserialize PKCS#8 keyfiles such that you can access components of the key. You can also pass these public and private key structures directly to the TLS implementation (coming soon).</p>
<p>PKCS#8 typically encodes keydata using the following workflow:</p>
<ol class="arabic simple">
<li><p>The components of the key are encoded using ASN.1/DER. <a class="reference internal" href="#spec"><span class="std std-ref">Click here</span></a> for more details.</p></li>
<li><p>The ASN.1 structure is then encoded using Base64/PEM.</p></li>
<li><p>The key data is wrapped in a header/footer banner indicating the type of key. These banners may be:</p></li>
</ol>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">-----</span><span class="n">BEGIN</span><span class="w"> </span><span class="n">PUBLIC</span><span class="w"> </span><span class="n">KEY</span><span class="o">-----</span>
<span class="n">base64</span><span class="o">-</span><span class="n">encoded</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="n">key</span>
<span class="o">-----</span><span class="n">END</span><span class="w"> </span><span class="n">PUBLIC</span><span class="w"> </span><span class="n">KEY</span><span class="o">-----</span>

<span class="o">-----</span><span class="n">BEGIN</span><span class="w"> </span><span class="n">PRIVATE</span><span class="w"> </span><span class="n">KEY</span><span class="o">-----</span>
<span class="n">base64</span><span class="o">-</span><span class="n">encoded</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span>
<span class="o">-----</span><span class="n">END</span><span class="w"> </span><span class="n">PRIVATE</span><span class="w"> </span><span class="n">KEY</span><span class="o">-----</span>

<span class="o">-----</span><span class="n">BEGIN</span><span class="w"> </span><span class="n">ENCRYPTED</span><span class="w"> </span><span class="n">PRIVATE</span><span class="w"> </span><span class="n">KEY</span><span class="o">-----</span>
<span class="n">base64</span><span class="o">-</span><span class="n">encoded</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">key</span>
<span class="o">-----</span><span class="n">END</span><span class="w"> </span><span class="n">ENCRYPTED</span><span class="w"> </span><span class="n">PRIVATE</span><span class="w"> </span><span class="n">KEY</span><span class="o">-----</span>
</pre></div>
</div>
</div></blockquote>
<div class="section" id="structures">
<h2>Structures<a class="headerlink" href="#structures" title="Permalink to this headline"></a></h2>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv419cryptx_pkcs8_pubkey">
<span id="_CPPv319cryptx_pkcs8_pubkey"></span><span id="_CPPv219cryptx_pkcs8_pubkey"></span><span id="cryptx_pkcs8_pubkey"></span><span class="target" id="structcryptx__pkcs8__pubkey"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_pkcs8_pubkey</span></span></span><a class="headerlink" href="#_CPPv419cryptx_pkcs8_pubkey" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines a structure for holding imported RSA or ECC public key data. </p>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv420cryptx_pkcs8_privkey">
<span id="_CPPv320cryptx_pkcs8_privkey"></span><span id="_CPPv220cryptx_pkcs8_privkey"></span><span id="cryptx_pkcs8_privkey"></span><span class="target" id="structcryptx__pkcs8__privkey"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_pkcs8_privkey</span></span></span><a class="headerlink" href="#_CPPv420cryptx_pkcs8_privkey" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines a structure for holding imported RSA or ECC private key data. </p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These structures, particularly <strong>cryptx_pkcs8_privkey</strong>, take up a lot of memory. This module uses dynamic allocation to optimize storage requirements for these structures to the best extent possible. Each structure contains a static portion which contains references to a dump of the raw data of the key and the dump section is of variable size depending on the size of the key.</p>
</div>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline"></a></h2>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv429cryptx_pkcs8_import_publickeyPv6size_tPFPv6size_tE">
<span id="_CPPv329cryptx_pkcs8_import_publickeyPv6size_tPFPv6size_tE"></span><span id="_CPPv229cryptx_pkcs8_import_publickeyPv6size_tPFPv6size_tE"></span><span class="target" id="cryptx_8h_1aa187a2f43e4b3524082b0e8b649ae767"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv419cryptx_pkcs8_pubkey" title="cryptx_pkcs8_pubkey"><span class="n"><span class="pre">cryptx_pkcs8_pubkey</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_pkcs8_import_publickey</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">len</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">malloc</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv429cryptx_pkcs8_import_publickeyPv6size_tPFPv6size_tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Attempts to import a PKCS#8-encoded public key for RSA or ECC. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Pointer to PKCS#8-encoded key data. </p></li>
<li><p><strong>len</strong> – Length of key data to import. </p></li>
<li><p><strong>malloc</strong> – Pointer to toolchain <strong>malloc</strong> function. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A malloc’d <strong><a class="reference internal" href="#structcryptx__pkcs8__pubkey"><span class="std std-ref">cryptx_pkcs8_pubkey</span></a></strong> structure populated with key metadata. </p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The <strong>error</strong> field of the structure set to <strong>True</strong> if an internal error occured. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv430cryptx_pkcs8_import_privatekeyPv6size_tPFPv6size_tE">
<span id="_CPPv330cryptx_pkcs8_import_privatekeyPv6size_tPFPv6size_tE"></span><span id="_CPPv230cryptx_pkcs8_import_privatekeyPv6size_tPFPv6size_tE"></span><span class="target" id="cryptx_8h_1a1d8ba96af68c8fe00b1aed438fff3495"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv420cryptx_pkcs8_privkey" title="cryptx_pkcs8_privkey"><span class="n"><span class="pre">cryptx_pkcs8_privkey</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_pkcs8_import_privatekey</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">len</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">malloc</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv430cryptx_pkcs8_import_privatekeyPv6size_tPFPv6size_tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Attempts to import a PKCS#8-encoded private key for RSA or ECC. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Pointer to PKCS#8-encoded key data. </p></li>
<li><p><strong>len</strong> – Length of key data to import. </p></li>
<li><p><strong>malloc</strong> – Pointer to toolchain <strong>malloc</strong> function. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A malloc’d <strong><a class="reference internal" href="#structcryptx__pkcs8__privkey"><span class="std std-ref">cryptx_pkcs8_privkey</span></a></strong> structure populated with key metadata. </p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The <strong>error</strong> field of the structure set to <strong>True</strong> if an internal error occured. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427cryptx_pkcs8_free_publickeyP19cryptx_pkcs8_pubkeyPFvPvE">
<span id="_CPPv327cryptx_pkcs8_free_publickeyP19cryptx_pkcs8_pubkeyPFvPvE"></span><span id="_CPPv227cryptx_pkcs8_free_publickeyP19cryptx_pkcs8_pubkeyPFvPvE"></span><span class="target" id="cryptx_8h_1a78fb5286dbb1dd4443ca8fbc33005750"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_pkcs8_free_publickey</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv419cryptx_pkcs8_pubkey" title="cryptx_pkcs8_pubkey"><span class="n"><span class="pre">cryptx_pkcs8_pubkey</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pk</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">free</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427cryptx_pkcs8_free_publickeyP19cryptx_pkcs8_pubkeyPFvPvE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Erases a PKCS#8 public key structure returned by <strong>cryptx_pkcs8_import_publickey</strong> and then frees the allocated memory. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pk</strong> – Pointer to a PKCS#8 public key structure. </p></li>
<li><p><strong>free</strong> – Pointer to toolchain <strong>free</strong> function. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv428cryptx_pkcs8_free_privatekeyP20cryptx_pkcs8_privkeyPFvPvE">
<span id="_CPPv328cryptx_pkcs8_free_privatekeyP20cryptx_pkcs8_privkeyPFvPvE"></span><span id="_CPPv228cryptx_pkcs8_free_privatekeyP20cryptx_pkcs8_privkeyPFvPvE"></span><span class="target" id="cryptx_8h_1a793f8cb12a267c4c2cff1bcc494f2de3"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_pkcs8_free_privatekey</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv420cryptx_pkcs8_privkey" title="cryptx_pkcs8_privkey"><span class="n"><span class="pre">cryptx_pkcs8_privkey</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pk</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">free</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv428cryptx_pkcs8_free_privatekeyP20cryptx_pkcs8_privkeyPFvPvE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Erases a PKCS#8 private key structure returned by <strong>cryptx_pkcs8_import_privatekey</strong> and then frees the allocated memory. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pk</strong> – Pointer to a PKCS#8 private key structure. </p></li>
<li><p><strong>free</strong> – Pointer to toolchain <strong>free</strong> function. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p>You can import your keyfiles like so:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">pubkey_fname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MyPub&quot;</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">privkey_fname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MyPriv&quot;</span><span class="p">;</span>
<span class="kt">uint8_t</span><span class="w"> </span><span class="n">fp</span><span class="p">;</span>
<span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">key_data</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">key_len</span><span class="p">;</span>

<span class="c1">// load pubkey from file (requires FILEIOC library)</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ti_Open</span><span class="p">(</span><span class="n">pubkey_fname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;File IO Error&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">key_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ti_GetDataPtr</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="n">key_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ti_GetSize</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="n">ti_Close</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="n">cryptx_pkcs8_pubkey</span><span class="w"> </span><span class="o">*</span><span class="n">pub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cryptx_pkcs8_import_publickey</span><span class="p">(</span><span class="n">key_data</span><span class="p">,</span><span class="w"> </span><span class="n">key_len</span><span class="p">,</span><span class="w"> </span><span class="n">malloc</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">pub</span><span class="p">){</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Alloc error!&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="n">pub</span><span class="o">-&gt;</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Deserialization error!&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">exit</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// load pubkey from file (requires FILEIOC library)</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ti_Open</span><span class="p">(</span><span class="n">privkey_fname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;File IO Error&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">key_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ti_GetDataPtr</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="n">key_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ti_GetSize</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="n">ti_Close</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="n">cryptx_pkcs8_privkey</span><span class="w"> </span><span class="o">*</span><span class="n">priv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cryptx_pkcs8_import_privatekey</span><span class="p">(</span><span class="n">key_data</span><span class="p">,</span><span class="w"> </span><span class="n">key_len</span><span class="p">,</span><span class="w"> </span><span class="n">malloc</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">priv</span><span class="p">){</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Alloc error!&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Deserialization error!&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">exit</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// these structs can be passed directly to the TLS implementation (coming soon)</span>
<span class="c1">// or the members can be accessed directly for advanced usage.</span>
</pre></div>
</div>
</div>
<div class="section" id="additional-info">
<span id="spec"></span><h2>Additional Info<a class="headerlink" href="#additional-info" title="Permalink to this headline"></a></h2>
<div class="section" id="pkcs-8-specification">
<h3>PKCS#8 Specification<a class="headerlink" href="#pkcs-8-specification" title="Permalink to this headline"></a></h3>
<p>This section details the PKCS#8 encoding format for public and private key files.</p>
<div class="highlight-asn1 notranslate"><div class="highlight"><pre><span></span><span class="n n-Type">PublicKeyInfo</span><span class="w"> </span><span class="o">::=</span><span class="w"> </span><span class="kd">SEQUENCE</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nv">algorithm</span><span class="w"> </span><span class="o">::=</span><span class="w"> </span><span class="kd">SEQUENCE</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nv">algorithm</span><span class="w">   </span><span class="kt">OBJECT IDENTIFIER</span><span class="p">,</span>
<span class="w">    </span><span class="nv">parameters</span><span class="w">  </span><span class="n n-Type">ANY</span><span class="w"> </span><span class="n n-Type">DEFINED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="nv">algorithm</span><span class="w"> </span><span class="kd">OPTIONAL</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n n-Type">PublicKey</span><span class="w">   </span><span class="kt">BIT STRING</span>
<span class="p">}</span>

<span class="n n-Type">PrivateKeyInfo</span><span class="w"> </span><span class="o">::=</span><span class="w"> </span><span class="kd">SEQUENCE</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nv">version</span><span class="w"> </span><span class="n n-Type">Version</span><span class="p">,</span>
<span class="w">  </span><span class="nv">algorithm</span><span class="w"> </span><span class="o">::=</span><span class="w"> </span><span class="kd">SEQUENCE</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nv">algorithm</span><span class="w">   </span><span class="kt">OBJECT IDENTIFIER</span><span class="p">,</span>
<span class="w">    </span><span class="nv">parameters</span><span class="w">  </span><span class="n n-Type">ANY</span><span class="w"> </span><span class="n n-Type">DEFINED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="nv">algorithm</span><span class="w"> </span><span class="kd">OPTIONAL</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n n-Type">PrivateKey</span><span class="w">  </span><span class="kt">BIT STRING</span>
<span class="p">}</span>

<span class="n n-Type">EncryptedPrivateKeyInfo</span><span class="w"> </span><span class="o">::=</span><span class="w"> </span><span class="kd">SEQUENCE</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nv">encryptionAlgorithm</span><span class="w"> </span><span class="o">::=</span><span class="w"> </span><span class="kd">SEQUENCE</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nv">algorithm</span><span class="w">   </span><span class="kt">OBJECT IDENTIFIER</span><span class="p">,</span>
<span class="w">    </span><span class="nv">parameters</span><span class="w">  </span><span class="n n-Type">ANY</span><span class="w"> </span><span class="n n-Type">DEFINED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="nv">algorithm</span><span class="w"> </span><span class="kd">OPTIONAL</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nv">encryptedData</span><span class="w"> </span><span class="o">::=</span><span class="w"> </span><span class="kt">OCTET STRING</span><span class="w"> </span><span class="p">(</span><span class="nv">encrypts</span><span class="w"> </span><span class="n n-Type">PrivateKeyInfo</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For some key formats the <em>PublicKey</em> field further encodes a structure from a different standard. This is true for all CryptX use cases of these keys.</p>
<div class="highlight-asn1 notranslate"><div class="highlight"><pre><span></span><span class="c1">-- from PKCS#1, src: rfc3447 A.1.1</span>
<span class="n n-Type">RSAPublicKey</span><span class="w"> </span><span class="o">::=</span><span class="w"> </span><span class="kd">SEQUENCE</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nv">modulus</span><span class="w">         </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w">    </span><span class="c1">-- n</span>
<span class="w">  </span><span class="nv">publicExponent</span><span class="w">  </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w">    </span><span class="c1">-- e</span>
<span class="p">}</span>

<span class="c1">-- from PKCS#1, src: rfc3447 A.1.2</span>
<span class="n n-Type">RSAPrivateKey</span><span class="w"> </span><span class="o">::=</span><span class="w"> </span><span class="kd">SEQUENCE</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nv">version</span><span class="w">           </span><span class="n n-Type">Version</span><span class="p">,</span>
<span class="w">  </span><span class="nv">modulus</span><span class="w">           </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w">  </span><span class="c1">-- n</span>
<span class="w">  </span><span class="nv">publicExponent</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w">  </span><span class="c1">-- e</span>
<span class="w">  </span><span class="nv">privateExponent</span><span class="w">   </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w">  </span><span class="c1">-- d</span>
<span class="w">  </span><span class="nv">prime1</span><span class="w">            </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w">  </span><span class="c1">-- p</span>
<span class="w">  </span><span class="nv">prime2</span><span class="w">            </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w">  </span><span class="c1">-- q</span>
<span class="w">  </span><span class="nv">exponent1</span><span class="w">         </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w">  </span><span class="c1">-- d mod (p-1)</span>
<span class="w">  </span><span class="nv">exponent2</span><span class="w">         </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w">  </span><span class="c1">-- d mod (q-1)</span>
<span class="w">  </span><span class="nv">coefficient</span><span class="w">       </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w">  </span><span class="c1">-- (inverse of q) mod p</span>
<span class="w">  </span><span class="nv">otherPrimeInfos</span><span class="w">   </span><span class="n n-Type">OtherPrimeInfos</span><span class="w"> </span><span class="kd">OPTIONAL</span>
<span class="p">}</span>

<span class="c1">-- from SECG1, src: rfc5915 1.3</span>
<span class="n n-Type">ECPrivateKey</span><span class="w"> </span><span class="o">::=</span><span class="w"> </span><span class="kd">SEQUENCE</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nv">version</span><span class="w">     </span><span class="kt">INTEGER</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">ecPrivkeyVer1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">(</span><span class="nv">ecPrivkeyVer1</span><span class="p">),</span>
<span class="w">  </span><span class="nv">privateKey</span><span class="w">  </span><span class="kt">OCTET STRING</span><span class="p">,</span>
<span class="w">  </span><span class="nv">parameters</span><span class="w">  </span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="n n-Type">ECParameters</span><span class="w"> </span><span class="p">{{</span><span class="w"> </span><span class="n n-Type">NamedCurve</span><span class="w"> </span><span class="p">}}</span><span class="w"> </span><span class="kd">OPTIONAL</span><span class="p">,</span>
<span class="w">  </span><span class="nv">publicKey</span><span class="w">   </span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="kt">BIT STRING</span><span class="w"> </span><span class="kd">OPTIONAL</span>
<span class="p">}</span>

<span class="c1">-- from SECG1, src: rfc5915 2.2</span>
<span class="n n-Type">ECPublicKey</span><span class="w"> </span><span class="o">::=</span><span class="w"> </span><span class="n n-Type">ECPoint</span><span class="w"> </span><span class="o">::=</span><span class="w"> </span><span class="kt">OCTET STRING</span>
<span class="c1">-- first octet of key is 0x04 for uncompressed or 0x03 or 0x02 for compressed</span>
</pre></div>
</div>
</div>
<div class="section" id="object-identifier-reference">
<h3>Object Identifier Reference<a class="headerlink" href="#object-identifier-reference" title="Permalink to this headline"></a></h3>
<p>This section lists object identifiers for algorithms supported by this library. Developers should generally never need to use these as the library should handle it internally, but if you need them for other projects or even for custom implementations, here they are.</p>
<p><strong>Bear in mind that while this module can successfully import objects for most algorithm types, only the ones listed below can actually be USED by the library.</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 32%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Algorithm</p></th>
<th class="head"><p>Object Identifier</p></th>
<th class="head"><p>Bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>RSA</p></td>
<td><p>1.2.840.113549.1.1.1</p></td>
<td><p>$2A,$86,$48,$86,$F7,$0D,$01,$01,$01</p></td>
</tr>
<tr class="row-odd"><td><p>Elliptic Curve</p></td>
<td><p>1.2.840.10045.2.1</p></td>
<td><p>$2A,$86,$48,$CE,$3D,$02,$01</p></td>
</tr>
<tr class="row-even"><td><p>EC_SECT233K1</p></td>
<td><p>1.3.132.0.26</p></td>
<td><p>$2B,$81,$04,$00,$1A</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="CryptX Library" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hash.html" class="btn btn-neutral float-right" title="Secure Hashing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
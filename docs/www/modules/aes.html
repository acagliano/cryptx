<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Advanced Encryption Standard &mdash; CryptX  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/proof.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="RSA" href="rsa.html" />
    <link rel="prev" title="Bytearray Operations" href="bytes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> CryptX
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Recommended Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pkcs8.html">PKCS#8</a></li>
<li class="toctree-l1"><a class="reference internal" href="hash.html">Secure Hashing</a></li>
<li class="toctree-l1"><a class="reference internal" href="hmac.html">Hash-Based MAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="csrand.html">Secure Random Number Generator</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="bytes.html">Bytearray Operations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced Encryption Standard</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cipher-modes">Cipher Modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cipher-flags">Cipher Flags</a></li>
<li class="toctree-l2"><a class="reference internal" href="#macros">Macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="#response-codes">Response Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#initialization-vector-requirements">Initialization Vector Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rsa.html">RSA</a></li>
<li class="toctree-l1"><a class="reference internal" href="ec.html">Elliptic Curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="asn1.html">ASN.1/DER</a></li>
<li class="toctree-l1"><a class="reference internal" href="base64.html">Base64/PEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="hazmat.html">Hazardous Materials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../static/analysis.html">Analysis &amp; Overview</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CryptX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Advanced Encryption Standard</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="advanced-encryption-standard">
<span id="aes"></span><h1>Advanced Encryption Standard<a class="headerlink" href="#advanced-encryption-standard" title="Permalink to this headline"></a></h1>
<p style="background:rgba(176,196,222,.5); padding:10px; font-family:Arial; margin:20px 0;"><span style="font-weight:bold;">Module Functionality</span><br />Provides a fast, secure algorithm for two parties to exchange information privately using a single key for encryption and decryption. Advanced Encryption Standard is currently the gold standard for encryption and is one of the most widely-used encryption algorithms.</p>
<br />
<p style="background:rgba(128,128,128,.25); padding:10px; font-family:Arial; font-size:14px;"><span style="font-weight:bold;">#cryptxdevquotes:</span>&emsp;<span style="font-style:italic;">AE-fucking-S. On a goddamn calculator.</span><br /> -Adam Beckingham</p><div class="section" id="cipher-modes">
<h2>Cipher Modes<a class="headerlink" href="#cipher-modes" title="Permalink to this headline"></a></h2>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv423cryptx_aes_cipher_modes">
<span id="_CPPv323cryptx_aes_cipher_modes"></span><span id="_CPPv223cryptx_aes_cipher_modes"></span><span class="target" id="cryptx_8h_1a59334db45c5435de6ded4492dec34735"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_cipher_modes</span></span></span><a class="headerlink" href="#_CPPv423cryptx_aes_cipher_modes" title="Permalink to this definition"></a><br /></dt>
<dd><p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N23cryptx_aes_cipher_modes14CRYPTX_AES_CBCE">
<span id="_CPPv3N23cryptx_aes_cipher_modes14CRYPTX_AES_CBCE"></span><span id="_CPPv2N23cryptx_aes_cipher_modes14CRYPTX_AES_CBCE"></span><span class="target" id="cryptx_8h_1a59334db45c5435de6ded4492dec34735a6d022763befad1bcebcda6aa597c5e55"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_CBC</span></span></span><a class="headerlink" href="#_CPPv4N23cryptx_aes_cipher_modes14CRYPTX_AES_CBCE" title="Permalink to this definition"></a><br /></dt>
<dd><p>selects Cyclic Block Chain (CBC) mode </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N23cryptx_aes_cipher_modes14CRYPTX_AES_CTRE">
<span id="_CPPv3N23cryptx_aes_cipher_modes14CRYPTX_AES_CTRE"></span><span id="_CPPv2N23cryptx_aes_cipher_modes14CRYPTX_AES_CTRE"></span><span class="target" id="cryptx_8h_1a59334db45c5435de6ded4492dec34735a11d9f7cd52007c22ac9adbc45bf0442d"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_CTR</span></span></span><a class="headerlink" href="#_CPPv4N23cryptx_aes_cipher_modes14CRYPTX_AES_CTRE" title="Permalink to this definition"></a><br /></dt>
<dd><p>selects Counter (CTR) mode </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N23cryptx_aes_cipher_modes14CRYPTX_AES_GCME">
<span id="_CPPv3N23cryptx_aes_cipher_modes14CRYPTX_AES_GCME"></span><span id="_CPPv2N23cryptx_aes_cipher_modes14CRYPTX_AES_GCME"></span><span class="target" id="cryptx_8h_1a59334db45c5435de6ded4492dec34735a0b6b05da37ef303c018bedd8cdbd4b6f"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_GCM</span></span></span><a class="headerlink" href="#_CPPv4N23cryptx_aes_cipher_modes14CRYPTX_AES_GCME" title="Permalink to this definition"></a><br /></dt>
<dd><p>selects Galois Counter (GCM) mode </p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="cipher-flags">
<h2>Cipher Flags<a class="headerlink" href="#cipher-flags" title="Permalink to this headline"></a></h2>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv426cryptx_aes_padding_schemes">
<span id="_CPPv326cryptx_aes_padding_schemes"></span><span id="_CPPv226cryptx_aes_padding_schemes"></span><span class="target" id="cryptx_8h_1a66b61f98ab7705ff93bde98685ff3433"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_padding_schemes</span></span></span><a class="headerlink" href="#_CPPv426cryptx_aes_padding_schemes" title="Permalink to this definition"></a><br /></dt>
<dd><p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N26cryptx_aes_padding_schemes9PAD_PKCS7E">
<span id="_CPPv3N26cryptx_aes_padding_schemes9PAD_PKCS7E"></span><span id="_CPPv2N26cryptx_aes_padding_schemes9PAD_PKCS7E"></span><span class="target" id="cryptx_8h_1a66b61f98ab7705ff93bde98685ff3433a673ae2fee0bfe0a962717b3f673b9b7c"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PAD_PKCS7</span></span></span><a class="headerlink" href="#_CPPv4N26cryptx_aes_padding_schemes9PAD_PKCS7E" title="Permalink to this definition"></a><br /></dt>
<dd><p>PKCS#7 padding | DEFAULT. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N26cryptx_aes_padding_schemes11PAD_DEFAULTE">
<span id="_CPPv3N26cryptx_aes_padding_schemes11PAD_DEFAULTE"></span><span id="_CPPv2N26cryptx_aes_padding_schemes11PAD_DEFAULTE"></span><span class="target" id="cryptx_8h_1a66b61f98ab7705ff93bde98685ff3433a322c11c9058ef67073a3ff9bdcb9f759"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PAD_DEFAULT</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N26cryptx_aes_padding_schemes9PAD_PKCS7E" title="cryptx_aes_padding_schemes::PAD_PKCS7"><span class="n"><span class="pre">PAD_PKCS7</span></span></a><a class="headerlink" href="#_CPPv4N26cryptx_aes_padding_schemes11PAD_DEFAULTE" title="Permalink to this definition"></a><br /></dt>
<dd><p>selects the scheme marked DEFAULT. </p>
<p>Using this is recommended in case a change to the standards would set a stronger padding scheme as default </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N26cryptx_aes_padding_schemes8PAD_ISO2E">
<span id="_CPPv3N26cryptx_aes_padding_schemes8PAD_ISO2E"></span><span id="_CPPv2N26cryptx_aes_padding_schemes8PAD_ISO2E"></span><span class="target" id="cryptx_8h_1a66b61f98ab7705ff93bde98685ff3433a7566d9371110a1a24db62b145c901ad8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PAD_ISO2</span></span></span><a class="headerlink" href="#_CPPv4N26cryptx_aes_padding_schemes8PAD_ISO2E" title="Permalink to this definition"></a><br /></dt>
<dd><p>ISO-9797 M2 padding. </p>
</dd></dl>

</dd></dl>

<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv424cryptx_aes_default_flags">
<span id="_CPPv324cryptx_aes_default_flags"></span><span id="_CPPv224cryptx_aes_default_flags"></span><span class="target" id="cryptx_8h_1a747439e5980be6f5f9fa0c8fbb84655a"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_default_flags</span></span></span><a class="headerlink" href="#_CPPv424cryptx_aes_default_flags" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines defaults for various cipher modes. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N24cryptx_aes_default_flags23CRYPTX_AES_CBC_DEFAULTSE">
<span id="_CPPv3N24cryptx_aes_default_flags23CRYPTX_AES_CBC_DEFAULTSE"></span><span id="_CPPv2N24cryptx_aes_default_flags23CRYPTX_AES_CBC_DEFAULTSE"></span><span class="target" id="cryptx_8h_1a747439e5980be6f5f9fa0c8fbb84655aaf6ef52028db1d536e3c076574a44ee96"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_CBC_DEFAULTS</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">PAD_DEFAULT</span></span><span class="w"> </span><span class="o"><span class="pre">|</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N24cryptx_aes_default_flags23CRYPTX_AES_CBC_DEFAULTSE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N24cryptx_aes_default_flags23CRYPTX_AES_CTR_DEFAULTSE">
<span id="_CPPv3N24cryptx_aes_default_flags23CRYPTX_AES_CTR_DEFAULTSE"></span><span id="_CPPv2N24cryptx_aes_default_flags23CRYPTX_AES_CTR_DEFAULTSE"></span><span class="target" id="cryptx_8h_1a747439e5980be6f5f9fa0c8fbb84655aaca82ad0c28139f15dfe3145b77271361"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_CTR_DEFAULTS</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0x0f</span></span><span class="w"> </span><span class="o"><span class="pre">&amp;</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">8</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="o"><span class="pre">&lt;&lt;</span></span><span class="w"> </span><span class="m"><span class="pre">6</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="o"><span class="pre">|</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0x0f</span></span><span class="w"> </span><span class="o"><span class="pre">&amp;</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">8</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="o"><span class="pre">&lt;&lt;</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="o"><span class="pre">|</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N24cryptx_aes_default_flags23CRYPTX_AES_CTR_DEFAULTSE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N24cryptx_aes_default_flags23CRYPTX_AES_GCM_DEFAULTSE">
<span id="_CPPv3N24cryptx_aes_default_flags23CRYPTX_AES_GCM_DEFAULTSE"></span><span id="_CPPv2N24cryptx_aes_default_flags23CRYPTX_AES_GCM_DEFAULTSE"></span><span class="target" id="cryptx_8h_1a747439e5980be6f5f9fa0c8fbb84655aa9488d8d057bdfcd2b6d399a15bb8dabd"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_GCM_DEFAULTS</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N24cryptx_aes_default_flags23CRYPTX_AES_GCM_DEFAULTSE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.cryptx_aes_cbc_flagset">
<span class="target" id="cryptx_8h_1a743d804a517a2e38d7f1224fdc8429f1"></span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_cbc_flagset</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">padding_mode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cryptx_aes_cbc_flagset" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines a macro to set flags for AES CBC mode. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.cryptx_aes_ctr_flagset">
<span class="target" id="cryptx_8h_1ab58fc147ecd3f0103486a14cf8254973"></span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_ctr_flagset</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">nonce_len</span></span>, <span class="n"><span class="pre">counter_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cryptx_aes_ctr_flagset" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines a macro to set flags for AES CTR mode. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.cryptx_aes_gcm_flagset">
<span class="target" id="cryptx_8h_1a7bffe1d673fd05c8e538d6169b12509f"></span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_gcm_flagset</span></span></span><a class="headerlink" href="#c.cryptx_aes_gcm_flagset" title="Permalink to this definition"></a><br /></dt>
<dd><p>GCM has no flags, pass 0 . </p>
</dd></dl>

</div>
<div class="section" id="macros">
<h2>Macros<a class="headerlink" href="#macros" title="Permalink to this headline"></a></h2>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_KEYLEN_AES128">
<span class="target" id="cryptx_8h_1aa9fde36ec3becdc849fcb37c14899544"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_KEYLEN_AES128</span></span></span><a class="headerlink" href="#c.CRYPTX_KEYLEN_AES128" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_KEYLEN_AES192">
<span class="target" id="cryptx_8h_1a4aa7074b0e57cf7d3f3eea983fc2547f"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_KEYLEN_AES192</span></span></span><a class="headerlink" href="#c.CRYPTX_KEYLEN_AES192" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_KEYLEN_AES256">
<span class="target" id="cryptx_8h_1a11632b2d2dcc8cc16684d896c140fb15"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_KEYLEN_AES256</span></span></span><a class="headerlink" href="#c.CRYPTX_KEYLEN_AES256" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_BLOCKSIZE_AES">
<span class="target" id="cryptx_8h_1ab571a7efb0b2dcb981d2876ab6e64d65"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_BLOCKSIZE_AES</span></span></span><a class="headerlink" href="#c.CRYPTX_BLOCKSIZE_AES" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.cryptx_aes_get_ciphertext_len">
<span class="target" id="cryptx_8h_1adf4062c77f37927bc0178872056602ff"></span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_get_ciphertext_len</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cryptx_aes_get_ciphertext_len" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines a macro to return the byte length of an AES ciphertext given a plaintext length. </p>
</dd></dl>

</div>
<div class="section" id="response-codes">
<h2>Response Codes<a class="headerlink" href="#response-codes" title="Permalink to this headline"></a></h2>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv411aes_error_t">
<span id="_CPPv311aes_error_t"></span><span id="_CPPv211aes_error_t"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfd"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">aes_error_t</span></span></span><a class="headerlink" href="#_CPPv411aes_error_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines response codes returned by the AES API. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t6AES_OKE">
<span id="_CPPv3N11aes_error_t6AES_OKE"></span><span id="_CPPv2N11aes_error_t6AES_OKE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfdaacf07636102724d2a7913911b0cf74b2"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_OK</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t6AES_OKE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation completed successfully. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t15AES_INVALID_ARGE">
<span id="_CPPv3N11aes_error_t15AES_INVALID_ARGE"></span><span id="_CPPv2N11aes_error_t15AES_INVALID_ARGE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfda6d39b280aea9d8d62d126eef05d271db"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_INVALID_ARG</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t15AES_INVALID_ARGE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation failed, bad argument. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t15AES_INVALID_MSGE">
<span id="_CPPv3N11aes_error_t15AES_INVALID_MSGE"></span><span id="_CPPv2N11aes_error_t15AES_INVALID_MSGE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfdaae5e9a591aeda666b0e425d9a05834e3"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_INVALID_MSG</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t15AES_INVALID_MSGE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation failed, message invalid. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t22AES_INVALID_CIPHERMODEE">
<span id="_CPPv3N11aes_error_t22AES_INVALID_CIPHERMODEE"></span><span id="_CPPv2N11aes_error_t22AES_INVALID_CIPHERMODEE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfdad2b49ffeabf14aaf47db3d1bad18f84e"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_INVALID_CIPHERMODE</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t22AES_INVALID_CIPHERMODEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation failed, cipher mode undefined. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t23AES_INVALID_PADDINGMODEE">
<span id="_CPPv3N11aes_error_t23AES_INVALID_PADDINGMODEE"></span><span id="_CPPv2N11aes_error_t23AES_INVALID_PADDINGMODEE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfda47bbd593fc3bdb7758a790bab86b41d9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_INVALID_PADDINGMODE</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t23AES_INVALID_PADDINGMODEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation failed, padding mode undefined. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t22AES_INVALID_CIPHERTEXTE">
<span id="_CPPv3N11aes_error_t22AES_INVALID_CIPHERTEXTE"></span><span id="_CPPv2N11aes_error_t22AES_INVALID_CIPHERTEXTE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfdaba928751c773ffa0287e47e1f86eae8b"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_INVALID_CIPHERTEXT</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t22AES_INVALID_CIPHERTEXTE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation failed, ciphertext error. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t21AES_INVALID_OPERATIONE">
<span id="_CPPv3N11aes_error_t21AES_INVALID_OPERATIONE"></span><span id="_CPPv2N11aes_error_t21AES_INVALID_OPERATIONE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfda95a9dcbf64347e3c6f2c50d05e8937f5"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_INVALID_OPERATION</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t21AES_INVALID_OPERATIONE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation failed, used encrypt context for decrypt or vice versa. </p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline"></a></h2>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415cryptx_aes_initP14cryptx_aes_ctxPKv6size_tPKv6size_t7uint8_t8uint24_t">
<span id="_CPPv315cryptx_aes_initP14cryptx_aes_ctxPKv6size_tPKv6size_t7uint8_t8uint24_t"></span><span id="_CPPv215cryptx_aes_initP14cryptx_aes_ctxPKv6size_tPKv6size_t7uint8_t8uint24_t"></span><span id="cryptx_aes_init__cryptx_aes_ctxP.voidCP.s.voidCP.s.uint8_t.uint24_t"></span><span class="target" id="cryptx_8h_1ab96be7c9efe78883e6b81bb7d66c7e45"></span><a class="reference internal" href="#_CPPv411aes_error_t" title="aes_error_t"><span class="n"><span class="pre">aes_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_init</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">cryptx_aes_ctx</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">key</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">keylen</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">iv</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ivlen</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cipher_mode</span></span>, <span class="n"><span class="pre">uint24_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">flags</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415cryptx_aes_initP14cryptx_aes_ctxPKv6size_tPKv6size_t7uint8_t8uint24_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initializes a stateful AES cipher context to be used for encryption or decryption. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to an AES cipher context to initialize. </p></li>
<li><p><strong>key</strong> – Pointer to an 128, 192, or 256 bit key to load into the AES context. </p></li>
<li><p><strong>keylen</strong> – The size, in bytes, of the <strong>key</strong> to load. </p></li>
<li><p><strong>iv</strong> – Pointer to Initialization vector, a buffer equal to the block size filled with random bytes. </p></li>
<li><p><strong>ivlen</strong> – Length of the initalization vector. Capped at 16 bytes. Certain cipher modes have different recommendations. </p></li>
<li><p><strong>cipher_mode</strong> – Operational mode of the cipher to initialize. </p></li>
<li><p><strong>flags</strong> – A series of flags to configure the AES context with. Use the provided <strong>defaults</strong> enumeration or the <strong>flagset</strong> macros above. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <strong>aes_error_t</strong> indicating the status of the AES operation. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cryptx_aes_encryptPK14cryptx_aes_ctxPKv6size_tPv">
<span id="_CPPv318cryptx_aes_encryptPK14cryptx_aes_ctxPKv6size_tPv"></span><span id="_CPPv218cryptx_aes_encryptPK14cryptx_aes_ctxPKv6size_tPv"></span><span id="cryptx_aes_encrypt__cryptx_aes_ctxCP.voidCP.s.voidP"></span><span class="target" id="cryptx_8h_1a571d4b9eb0fe3d069b10492025e47fe0"></span><a class="reference internal" href="#_CPPv411aes_error_t" title="aes_error_t"><span class="n"><span class="pre">aes_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_encrypt</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">cryptx_aes_ctx</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">plaintext</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">len</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ciphertext</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cryptx_aes_encryptPK14cryptx_aes_ctxPKv6size_tPv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Performs a stateful AES encryption of an arbitrary length of data. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to an AES cipher context. </p></li>
<li><p><strong>plaintext</strong> – Pointer to data to encrypt. </p></li>
<li><p><strong>len</strong> – Length of data at <strong>plaintext</strong> to encrypt. </p></li>
<li><p><strong>ciphertext</strong> – Pointer to buffer to write encrypted data to. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <strong>aes_error_t</strong> indicating the status of the AES operation. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cryptx_aes_decryptPK14cryptx_aes_ctxPKv6size_tPv">
<span id="_CPPv318cryptx_aes_decryptPK14cryptx_aes_ctxPKv6size_tPv"></span><span id="_CPPv218cryptx_aes_decryptPK14cryptx_aes_ctxPKv6size_tPv"></span><span id="cryptx_aes_decrypt__cryptx_aes_ctxCP.voidCP.s.voidP"></span><span class="target" id="cryptx_8h_1ab5cf162f80d83c86c9dbba9aa866b289"></span><a class="reference internal" href="#_CPPv411aes_error_t" title="aes_error_t"><span class="n"><span class="pre">aes_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_decrypt</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">cryptx_aes_ctx</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ciphertext</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">len</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">plaintext</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cryptx_aes_decryptPK14cryptx_aes_ctxPKv6size_tPv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Performs a stateful AES decryption of an arbitrary length of data. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to AES cipher context. </p></li>
<li><p><strong>ciphertext</strong> – Pointer to data to decrypt. </p></li>
<li><p><strong>len</strong> – Length of data at <strong>ciphertext</strong> to decrypt. </p></li>
<li><p><strong>plaintext</strong> – Pointer to buffer to write decryped data to. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <strong>aes_error_t</strong> indicating the status of the AES operation. </p>
</dd>
</dl>
</dd></dl>

<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">cryptx_aes_ctx</span><span class="w"> </span><span class="n">aes</span><span class="p">;</span>
<span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;The fox jumped over the dog!&quot;</span><span class="p">;</span>
<span class="kt">uint8_t</span><span class="w"> </span><span class="n">aes_key</span><span class="p">[</span><span class="n">CRYPTX_KEYLEN_AES256</span><span class="p">],</span>
<span class="w">        </span><span class="n">aes_iv</span><span class="p">[</span><span class="n">CRYPTX_BLOCKSIZE_AES</span><span class="p">];</span>

<span class="c1">// generate random key</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">cryptx_csrand_fill</span><span class="p">(</span><span class="n">aes_key</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">aes_key</span><span class="p">)))</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
<span class="c1">// generate random iv</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">cryptx_csrand_fill</span><span class="p">(</span><span class="n">aes_iv</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">aes_iv</span><span class="p">)))</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="n">cryptx_aes_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">aes</span><span class="p">,</span><span class="w"> </span><span class="n">aes_key</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">aes_key</span><span class="p">),</span>
<span class="w">                </span><span class="n">aes_iv</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">aes_iv</span><span class="p">),</span>
<span class="w">                </span><span class="n">CRYPTX_AES_GCM</span><span class="p">,</span><span class="w"> </span><span class="n">CRYPTX_AES_GCM_DEFAULTS</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_OK</span><span class="p">)</span>
<span class="w">  </span><span class="k">return</span><span class="p">;</span>

<span class="kt">size_t</span><span class="w"> </span><span class="n">encr_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<span class="n">cryptx_aes_encrypt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">aes</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">encr_len</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">);</span>

<span class="n">network_send</span><span class="p">(</span><span class="n">aes_iv</span><span class="p">,</span><span class="w"> </span><span class="n">CRYPTX_BLOCKSIZE_AES</span><span class="p">);</span>
<span class="n">network_send</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">encr_len</span><span class="p">);</span>
</pre></div>
</div>
<hr class="docutils" />
<p>The following functions are only valid for Galois Counter Mode (GCM). Attempting to use them for any other cipher mode will return <strong>AES_INVALID_CIPHERMODE</strong>.</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421cryptx_aes_update_aadP14cryptx_aes_ctxPKv6size_t">
<span id="_CPPv321cryptx_aes_update_aadP14cryptx_aes_ctxPKv6size_t"></span><span id="_CPPv221cryptx_aes_update_aadP14cryptx_aes_ctxPKv6size_t"></span><span id="cryptx_aes_update_aad__cryptx_aes_ctxP.voidCP.s"></span><span class="target" id="cryptx_8h_1a3d55233d4178e3f6c6b96272fda56ae0"></span><a class="reference internal" href="#_CPPv411aes_error_t" title="aes_error_t"><span class="n"><span class="pre">aes_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_update_aad</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">cryptx_aes_ctx</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">aad</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">aad_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421cryptx_aes_update_aadP14cryptx_aes_ctxPKv6size_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Updates the cipher context for given AAD (Additional Authenticated Data). </p>
<p>AAD is data that is only authenticated, not encrypted. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to an AES context. </p></li>
<li><p><strong>aad</strong> – Pointer to additional authenticated data segment. </p></li>
<li><p><strong>aad_len</strong> – Length of additional data segment. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <strong>aes_error_t</strong> indicating the status of the AES operation. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417cryptx_aes_digestP14cryptx_aes_ctxP7uint8_t">
<span id="_CPPv317cryptx_aes_digestP14cryptx_aes_ctxP7uint8_t"></span><span id="_CPPv217cryptx_aes_digestP14cryptx_aes_ctxP7uint8_t"></span><span id="cryptx_aes_digest__cryptx_aes_ctxP.uint8_tP"></span><span class="target" id="cryptx_8h_1a7aaae6b33efe97c579d24729680eda79"></span><a class="reference internal" href="#_CPPv411aes_error_t" title="aes_error_t"><span class="n"><span class="pre">aes_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_digest</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">cryptx_aes_ctx</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">digest</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417cryptx_aes_digestP14cryptx_aes_ctxP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Returns the current authentication tag for data parsed so far. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to an AES context </p></li>
<li><p><strong>digest</strong> – Pointer to a buffer to output digest to. Must be at least 16 bytes large. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <strong>aes_error_t</strong> indicating the status of the AES operation. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417cryptx_aes_verifyPK14cryptx_aes_ctxPKv6size_tPKv6size_tP7uint8_t">
<span id="_CPPv317cryptx_aes_verifyPK14cryptx_aes_ctxPKv6size_tPKv6size_tP7uint8_t"></span><span id="_CPPv217cryptx_aes_verifyPK14cryptx_aes_ctxPKv6size_tPKv6size_tP7uint8_t"></span><span id="cryptx_aes_verify__cryptx_aes_ctxCP.voidCP.s.voidCP.s.uint8_tP"></span><span class="target" id="cryptx_8h_1a69437bd1ca1d4fe40dc50d91da7c1be4"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_verify</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">cryptx_aes_ctx</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">aad</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">aad_len</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ciphertext</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ciphertext_len</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">tag</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417cryptx_aes_verifyPK14cryptx_aes_ctxPKv6size_tPKv6size_tP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Parses the specified AAD and ciphertext and then compares the output auth tag to an expected auth tag. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to an AES context. </p></li>
<li><p><strong>aad</strong> – Pointer to associated data to authenticate. </p></li>
<li><p><strong>aad_len</strong> – Length of associated data to authenticate. </p></li>
<li><p><strong>ciphertext</strong> – Pointer to ciphertext to authenticate. </p></li>
<li><p><strong>ciphertext_len</strong> – Length of ciphertext to authenticate. </p></li>
<li><p><strong>tag</strong> – Pointer to expected auth tag to validate against. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TRUE if authentication tag matches expected, FALSE otherwise. </p>
</dd>
</dl>
</dd></dl>

<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">cryptx_aes_ctx</span><span class="w"> </span><span class="n">aes</span><span class="p">;</span>
<span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;The fox jumped over the dog!&quot;</span><span class="p">;</span>
<span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;A header string.&quot;</span><span class="p">;</span>
<span class="kt">uint8_t</span><span class="w"> </span><span class="n">aes_key</span><span class="p">[</span><span class="n">CRYPTX_KEYLEN_AES256</span><span class="p">],</span>
<span class="w">        </span><span class="n">aes_iv</span><span class="p">[</span><span class="n">CRYPTX_BLOCKSIZE_AES</span><span class="p">],</span>
<span class="w">        </span><span class="n">auth_tag</span><span class="p">[</span><span class="n">CRYPTX_BLOCKSIZE_AES</span><span class="p">];</span>

<span class="c1">// generate random key</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">cryptx_csrand_fill</span><span class="p">(</span><span class="n">aes_key</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">aes_key</span><span class="p">)))</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
<span class="c1">// generate random iv</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">cryptx_csrand_fill</span><span class="p">(</span><span class="n">aes_iv</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">aes_iv</span><span class="p">)))</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="n">cryptx_aes_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">aes</span><span class="p">,</span><span class="w"> </span><span class="n">aes_key</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">aes_key</span><span class="p">),</span>
<span class="w">                </span><span class="n">aes_iv</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">aes_iv</span><span class="p">),</span>
<span class="w">                </span><span class="n">CRYPTX_AES_GCM</span><span class="p">,</span><span class="w"> </span><span class="n">CRYPTX_AES_GCM_DEFAULTS</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_OK</span><span class="p">)</span>
<span class="w">  </span><span class="k">return</span><span class="p">;</span>

<span class="kt">size_t</span><span class="w"> </span><span class="n">encr_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<span class="n">cryptx_aes_update_aad</span><span class="p">(</span><span class="o">&amp;</span><span class="n">aes</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="p">,</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">header</span><span class="p">));</span>
<span class="n">cryptx_aes_encrypt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">aes</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">encr_len</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">);</span>
<span class="n">cryptx_aes_digest</span><span class="p">(</span><span class="o">&amp;</span><span class="n">aes</span><span class="p">,</span><span class="w"> </span><span class="n">auth_tag</span><span class="p">);</span>

<span class="n">network_send</span><span class="p">(</span><span class="n">aes_iv</span><span class="p">,</span><span class="w"> </span><span class="n">CRYPTX_BLOCKSIZE_AES</span><span class="p">);</span>
<span class="n">network_send</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">encr_len</span><span class="p">);</span>
<span class="n">network_send</span><span class="p">(</span><span class="n">auth_tag</span><span class="p">,</span><span class="w"> </span><span class="n">CRYPTX_BLOCKSIZE_AES</span><span class="p">);</span>
</pre></div>
</div>
<p>There are also some enforced constraints on when these functions can be called, intended to prevent undefined behavior as well as to close a particularly nasty tag-forgery vulnerability <a class="footnote-reference brackets" href="#f1" id="id1">1</a> in GCM.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="4"><p>GCM FUNCTION VALIDITY CONTROL FLOW</p></th>
</tr>
<tr class="row-even"><th class="head"><p>After Function Call</p></th>
<th class="head"><p>cryptx_aes_update_aad</p></th>
<th class="head"><p>cryptx_aes_encrypt</p></th>
<th class="head"><p>cryptx_aes_digest</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>cryptx_aes_init</p></td>
<td><p>VALID</p></td>
<td><p>VALID</p></td>
<td><p>VALID</p></td>
</tr>
<tr class="row-even"><td><p>cryptx_aes_update_aad</p></td>
<td><p>VALID</p></td>
<td><p>VALID</p></td>
<td><p>VALID</p></td>
</tr>
<tr class="row-odd"><td><p>cryptx_aes_encrypt</p></td>
<td><p>INVALID</p></td>
<td><p>VALID</p></td>
<td><p>VALID</p></td>
</tr>
<tr class="row-even"><td><p>cryptx_aes_digest</p></td>
<td><p>INVALID</p></td>
<td><p>INVALID</p></td>
<td><p>INVALID</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="initialization-vector-requirements">
<span id="aes-iv-req"></span><h2>Initialization Vector Requirements<a class="headerlink" href="#initialization-vector-requirements" title="Permalink to this headline"></a></h2>
<ul>
<li><p><strong>CBC Mode</strong></p>
<div class="line-block">
<div class="line"><strong>Requirement</strong>: Initialization vector must be securely-random.</div>
<div class="line"><strong>Non-Compliance Effect</strong>: Vulnerability to chosen plaintext attack <a class="footnote-reference brackets" href="#f2" id="id2">2</a>.</div>
<div class="line"><strong>Assurance</strong>: Generate a random IV with <code class="code docutils literal notranslate"><span class="pre">cryptx_csrand_fill</span></code> for use with this mode.</div>
</div>
</li>
<li><p><strong>CTR &amp; GCM Modes</strong></p>
<div class="line-block">
<div class="line"><strong>Requirement</strong>: Initialization vector must be unique (not re-used) over the same key.</div>
<div class="line"><strong>Non-Compliance Effect</strong>: Vulnerability to many-time pad <a class="footnote-reference brackets" href="#f3" id="id3">3</a>.</div>
<div class="line"><strong>Additional Options</strong>: A fixed nonce may preceed the counter portion of the IV. This should be securely random. Default configuration for CTR mode is an 8 byte nonce followed by an 8 byte counter, though this can be configured during cipher initialization.</div>
<div class="line"><strong>Assurance</strong>: For counter block of length <em>N</em> bits, after processing <code class="code docutils literal notranslate"><span class="pre">2</span> <span class="pre">^</span> <span class="pre">N</span></code> blocks of plaintext data: (1) generate new nonce/counter blocks and prepend to ciphertext, or (2) generate and negotiate new key.</div>
</div>
</li>
</ul>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline"></a></h2>
<ol class="arabic simple">
<li><p>The initialization vector used for the cipher state (or message for GCM mode) may be communicated to the other party as the first block of the ciphertext.</p></li>
<li><p>The AES cipher begins to leak information after a certain number of blocks have been encrypted under a single key. This number differs by cipher mode but can range anywhere from <code class="code docutils literal notranslate"><span class="pre">2</span> <span class="pre">^</span> <span class="pre">48</span></code> to <code class="code docutils literal notranslate"><span class="pre">2^64</span></code> blocks of data. This is a stupidly large amount of data that you will never realistically reach.</p></li>
<li><p>CBC and CTR modes by themselves ensure confidentiality but do not provide any assurances of message integrity or authenticity. If you need a truly secure construction, use GCM mode or append a keyed hash (HMAC) to the encrypted message.</p></li>
</ol>
<hr class="docutils" />
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p><strong>GCM Nonce-Misuse/Forbidden Attack Vulnerability</strong>. It involves the leaking of bits of the hash subkey used to generate the authentication tag if the same initialization vector is used to authenticate multiple messages. This allows an attacker to embed a valid signature for an altered message. To resolve this vulnerability within this GCM implementation call <code class="code docutils literal notranslate"><span class="pre">cryptx_aes_init</span></code> again with a new initialization vector after you return a digest for a data stream. For more details on this vulnerability <a class="reference external" href="https://csrc.nist.gov/csrc/media/Projects/crypto-publication-review-project/documents/initial-comments/sp800-38d-initial-public-comments-2021.pdf">click here</a>.</p>
</dd>
<dt class="label" id="f2"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p><strong>Chosen Plaintext Attack</strong>. An attack against a cryptosystem involving requesting multiple encryptions while controlling bits of the input plaintext. This allows an attacker to reveal bits of the encryption secret. To resolve this vulnerability the output of an encryption algorithm needs to be securely random. See <a class="reference internal" href="#aes-iv-req"><span class="std std-ref">Initialization Vector Requirements</span></a>.</p>
</dd>
<dt class="label" id="f3"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p><strong>Many-Time Pad</strong>. This vulnerability derived from the <strong>One-Time Pad</strong> algorithm which was one of the first encryption algorithms developed. It involved XOR’ing a message with a key of equal length and had perfect secrecy. Issues arose with this algorithm if the key began to repeat, which would reveal the plaintext given only a few ciphertexts. AES CTR and GCM modes use the counter block within the IV to generate a one-time pad and therefore are subject to this vulnerability. To resolve this vulnerability ensure that you do not allow your counter/nonce block combination to repeat under the same key.</p>
</dd>
</dl>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bytes.html" class="btn btn-neutral float-left" title="Bytearray Operations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="rsa.html" class="btn btn-neutral float-right" title="RSA" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
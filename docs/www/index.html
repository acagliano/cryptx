<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cryptography for the CE &mdash; CryptX  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CryptX Analysis &amp; Overview" href="static/analysis.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> CryptX
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="static/analysis.html">CryptX Analysis &amp; Overview</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">CryptX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>Cryptography for the CE</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="cryptography-for-the-ce">
<h1>Cryptography for the CE<a class="headerlink" href="#cryptography-for-the-ce" title="Permalink to this headline"></a></h1>
<p><strong>CryptX</strong> is a specialty library designed for integration with the TI-84+ CE toolchain that allows developers to easily implement cryptography into their projects without needing to worry about low-level implementation details. It also allows for bugfixes, feature additions, and changes to be pushed to the library usually without requiring developers to rebuild their projects.</p>
<p>If this is your first introduction to the CE Toolchain, check out the <a class="reference external" href="https://github.com/CE-Programming/toolchain">toolchain repository</a> and familiarize yourself with how it works.</p>
<p>You may be asking yourself “What makes CryptX any different than the many other tools on various forums claiming to hide or encrypt programs?”. In most cases those tools do not perform actual encryption but merely set a flag preventing the average person from seeing the programs. This does not prevent viewing, or even modification, of the data comprising those programs. This utility provides <strong>actual</strong> encryption. The following is an exhaustive list of what CryptX provides.</p>
<blockquote>
<div><ul class="simple">
<li><p>Hashing (Hash, HMAC, MGF1)</p></li>
<li><p>Password-Based Key Derivation</p></li>
<li><p>Secure Random Number Generation</p></li>
<li><p>Advanced Encryption Standard</p></li>
<li><p>Rivest-Shamir Adleman (RSA)</p></li>
<li><p>Elliptic Curve Diffie-Hellman (implements SECT233k1)</p></li>
<li><p>Abstract Syntax Notation One (ASN.1) and Base64 decoding</p></li>
<li><p>Timing-safe buffer comparison</p></li>
</ul>
</div></blockquote>
<p>Need more convincing? Check out the <a class="reference internal" href="static/analysis.html#analysis"><span class="std std-ref">CryptX Analysis &amp; Overview</span></a> for more technical implementation details including platform-specific security considerations.</p>
<p>Most of this library’s modules have been tested for compatibility with several other cryptographic libraries including <em>openssl</em>, <em>cryptodome/pycryptodome</em>, and <em>cryptography</em>, although in some cases where libraries do not expose their primitives, use of their <em>hazardous materials</em> layer may be required. If you do find an incompatibility with another cryptographic library, please open an issue on the <a class="reference external" href="https://github.com/acagliano/cryptx">CryptX Github</a>.</p>
<div class="section" id="additional-resources">
<h2>Additional Resources<a class="headerlink" href="#additional-resources" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="static/analysis.html">CryptX Analysis &amp; Overview</a></li>
</ul>
</div>
</div>
<div class="section" id="api-documentation">
<h2>API Documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline"></a></h2>
<div class="section" id="hashing">
<h3>Hashing<a class="headerlink" href="#hashing" title="Permalink to this headline"></a></h3>
<p>A <em>hash</em> is a cryptographic primitive that is used to determine if data has changed in storage or in transit.</p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv415cryptx_hash_ctx">
<span id="_CPPv315cryptx_hash_ctx"></span><span id="_CPPv215cryptx_hash_ctx"></span><span id="cryptx_hash_ctx"></span><span class="target" id="structcryptx__hash__ctx"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_hash_ctx</span></span></span><a class="headerlink" href="#_CPPv415cryptx_hash_ctx" title="Permalink to this definition"></a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15cryptx_hash_ctx4initE">
<span id="_CPPv3N15cryptx_hash_ctx4initE"></span><span id="_CPPv2N15cryptx_hash_ctx4initE"></span><span class="target" id="structcryptx__hash__ctx_1ae1cc61f269fa5bbf1e8a36b9526c138a"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">init</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N15cryptx_hash_ctx4initE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to function call for hash initialization. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15cryptx_hash_ctx6updateE">
<span id="_CPPv3N15cryptx_hash_ctx6updateE"></span><span id="_CPPv2N15cryptx_hash_ctx6updateE"></span><span class="target" id="structcryptx__hash__ctx_1abcba976dfec24f43bbd0af1f3c4abfeb"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">update</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">len</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N15cryptx_hash_ctx6updateE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to function call for hash update. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15cryptx_hash_ctx6digestE">
<span id="_CPPv3N15cryptx_hash_ctx6digestE"></span><span id="_CPPv2N15cryptx_hash_ctx6digestE"></span><span class="target" id="structcryptx__hash__ctx_1a1bc11de9717a516b5c0d053121e9851d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">digest</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">output</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N15cryptx_hash_ctx6digestE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to function call for digest output. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15cryptx_hash_ctx10digest_lenE">
<span id="_CPPv3N15cryptx_hash_ctx10digest_lenE"></span><span id="_CPPv2N15cryptx_hash_ctx10digest_lenE"></span><span id="cryptx_hash_ctx::digest_len__uint8_t"></span><span class="target" id="structcryptx__hash__ctx_1a6bceb7d80541e569377e5d3684fd1721"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">digest_len</span></span></span><a class="headerlink" href="#_CPPv4N15cryptx_hash_ctx10digest_lenE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Output length of hash digest, in bytes. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15cryptx_hash_ctx8metadataE">
<span id="_CPPv3N15cryptx_hash_ctx8metadataE"></span><span id="_CPPv2N15cryptx_hash_ctx8metadataE"></span><span id="cryptx_hash_ctx::metadata__cryptx_hash_private_h"></span><span class="target" id="structcryptx__hash__ctx_1a7ef6076b4878b27aea27fa71fc929a60"></span><span class="n"><span class="pre">cryptx_hash_private_h</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#_CPPv4N15cryptx_hash_ctx8metadataE" title="Permalink to this definition"></a><br /></dt>
<dd><p>PRIVATE, INTERNAL. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv422cryptx_hash_algorithms">
<span id="_CPPv322cryptx_hash_algorithms"></span><span id="_CPPv222cryptx_hash_algorithms"></span><span class="target" id="cryptx_8h_1a57f2f69b5ad395749c8604ca9f43f93b"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_hash_algorithms</span></span></span><a class="headerlink" href="#_CPPv422cryptx_hash_algorithms" title="Permalink to this definition"></a><br /></dt>
<dd><p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N22cryptx_hash_algorithms6SHA256E">
<span id="_CPPv3N22cryptx_hash_algorithms6SHA256E"></span><span id="_CPPv2N22cryptx_hash_algorithms6SHA256E"></span><span class="target" id="cryptx_8h_1a57f2f69b5ad395749c8604ca9f43f93bac7716785728694693ec29eccd5ffa0e1"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SHA256</span></span></span><a class="headerlink" href="#_CPPv4N22cryptx_hash_algorithms6SHA256E" title="Permalink to this definition"></a><br /></dt>
<dd><p>algorithm type identifier for SHA-256 </p>
</dd></dl>

</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416cryptx_hash_initP15cryptx_hash_ctx7uint8_t">
<span id="_CPPv316cryptx_hash_initP15cryptx_hash_ctx7uint8_t"></span><span id="_CPPv216cryptx_hash_initP15cryptx_hash_ctx7uint8_t"></span><span id="cryptx_hash_init__cryptx_hash_ctxP.uint8_t"></span><span class="target" id="cryptx_8h_1a70b79d7bbba52b64700123ab77ab5a28"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_hash_init</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv415cryptx_hash_ctx" title="cryptx_hash_ctx"><span class="n"><span class="pre">cryptx_hash_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hash_alg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416cryptx_hash_initP15cryptx_hash_ctx7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initializes a hash-state context for a specific hash algorithm. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Destroys 516 bytes of fastMem starting at 0xE30800. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to a hash-state context. </p></li>
<li><p><strong>hash_alg</strong> – The numeric ID of the hashing algorithm to use. See <strong>cryptx_hash_algorithms</strong>. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>true</strong> if hash initialization succeeded, <strong>false</strong> if failed. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cryptx_hash_updateP15cryptx_hash_ctxPKv6size_t">
<span id="_CPPv318cryptx_hash_updateP15cryptx_hash_ctxPKv6size_t"></span><span id="_CPPv218cryptx_hash_updateP15cryptx_hash_ctxPKv6size_t"></span><span id="cryptx_hash_update__cryptx_hash_ctxP.voidCP.s"></span><span class="target" id="cryptx_8h_1a0df23ee0aff04b31db05f5175bfe63a2"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_hash_update</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv415cryptx_hash_ctx" title="cryptx_hash_ctx"><span class="n"><span class="pre">cryptx_hash_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cryptx_hash_updateP15cryptx_hash_ctxPKv6size_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Updates the hash-state for a given block of data. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Destroys 516 bytes of fastMem starting at 0xE30800. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Calling this on a context that has not been initialized may have unpredictable results. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to a hash-state context. </p></li>
<li><p><strong>data</strong> – Pointer to a block of data to hash.. </p></li>
<li><p><strong>len</strong> – Size of the <strong>data</strong> to hash. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cryptx_hash_digestP15cryptx_hash_ctxPv">
<span id="_CPPv318cryptx_hash_digestP15cryptx_hash_ctxPv"></span><span id="_CPPv218cryptx_hash_digestP15cryptx_hash_ctxPv"></span><span id="cryptx_hash_digest__cryptx_hash_ctxP.voidP"></span><span class="target" id="cryptx_8h_1a1444bb4124409dbae8088ffbc9830ee3"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_hash_digest</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv415cryptx_hash_ctx" title="cryptx_hash_ctx"><span class="n"><span class="pre">cryptx_hash_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">digest</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cryptx_hash_digestP15cryptx_hash_ctxPv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Output digest for current hash-state (preserves state). </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>digest</strong> must be at large enough to hold the hash digest. You can retrieve the necessary size by accessing the <strong>digest_len</strong> member of an initialized <strong>cryptx_hash_ctx</strong>. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Destroys 516 bytes of fastMem starting at 0xE30800. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Calling this on a context that has not been initialized may have unpredictable results. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to a hash-state context. </p></li>
<li><p><strong>digest</strong> – Pointer to a buffer to write digest to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416cryptx_hash_mgf1PKv6size_tPv6size_t7uint8_t">
<span id="_CPPv316cryptx_hash_mgf1PKv6size_tPv6size_t7uint8_t"></span><span id="_CPPv216cryptx_hash_mgf1PKv6size_tPv6size_t7uint8_t"></span><span id="cryptx_hash_mgf1__voidCP.s.voidP.s.uint8_t"></span><span class="target" id="cryptx_8h_1a661281f90257c5e21dbb53654ba505e7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_hash_mgf1</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">datalen</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">outbuf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">outlen</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hash_alg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416cryptx_hash_mgf1PKv6size_tPv6size_t7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Computes a digest of arbitrary length for a given block of data. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>outbuf</strong> must be at least <strong>outlen</strong> bytes large. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Destroys 516 bytes of fastMem starting at 0xE30800. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Pointer to data to hash. </p></li>
<li><p><strong>datalen</strong> – Size of <strong>data</strong> to hash. </p></li>
<li><p><strong>outbuf</strong> – Pointer to buffer to write digest to. </p></li>
<li><p><strong>outlen</strong> – Number of bytes to write to <strong>outbuf</strong>. </p></li>
<li><p><strong>hash_alg</strong> – The numeric ID of the hashing algorithm to use. See <strong>cryptx_hash_algorithms</strong>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="hash-based-message-authentication-code-hmac">
<h3>Hash-Based Message Authentication Code (HMAC)<a class="headerlink" href="#hash-based-message-authentication-code-hmac" title="Permalink to this headline"></a></h3>
<p>An <em>HMAC</em> is a form of hash in which the initial state is transformed based on some application secret or random oracle known only to authorized parties. This allows for not only the integrity but also the authenticity of the information to be confirmed.</p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv415cryptx_hmac_ctx">
<span id="_CPPv315cryptx_hmac_ctx"></span><span id="_CPPv215cryptx_hmac_ctx"></span><span id="cryptx_hmac_ctx"></span><span class="target" id="structcryptx__hmac__ctx"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_hmac_ctx</span></span></span><a class="headerlink" href="#_CPPv415cryptx_hmac_ctx" title="Permalink to this definition"></a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15cryptx_hmac_ctx4initE">
<span id="_CPPv3N15cryptx_hmac_ctx4initE"></span><span id="_CPPv2N15cryptx_hmac_ctx4initE"></span><span class="target" id="structcryptx__hmac__ctx_1ad94b42907c9265c29e78b4438fcbeb30"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">init</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">keylen</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N15cryptx_hmac_ctx4initE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to function call for hmac initialization. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15cryptx_hmac_ctx6updateE">
<span id="_CPPv3N15cryptx_hmac_ctx6updateE"></span><span id="_CPPv2N15cryptx_hmac_ctx6updateE"></span><span class="target" id="structcryptx__hmac__ctx_1a02b8fb3b5fc0ba3c3e401cb8878b6b3b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">update</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">len</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N15cryptx_hmac_ctx6updateE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to function call for hmac update. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15cryptx_hmac_ctx6digestE">
<span id="_CPPv3N15cryptx_hmac_ctx6digestE"></span><span id="_CPPv2N15cryptx_hmac_ctx6digestE"></span><span class="target" id="structcryptx__hmac__ctx_1ab65e64eac18efc47f8753e659d5f4d3d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">digest</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">output</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N15cryptx_hmac_ctx6digestE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to function call for hmac digest output. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15cryptx_hmac_ctx10digest_lenE">
<span id="_CPPv3N15cryptx_hmac_ctx10digest_lenE"></span><span id="_CPPv2N15cryptx_hmac_ctx10digest_lenE"></span><span id="cryptx_hmac_ctx::digest_len__uint8_t"></span><span class="target" id="structcryptx__hmac__ctx_1ae379877c49e2e682861a975d9640607d"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">digest_len</span></span></span><a class="headerlink" href="#_CPPv4N15cryptx_hmac_ctx10digest_lenE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Length of output digest for hmac, in bytes. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N15cryptx_hmac_ctx8metadataE">
<span id="_CPPv3N15cryptx_hmac_ctx8metadataE"></span><span id="_CPPv2N15cryptx_hmac_ctx8metadataE"></span><span id="cryptx_hmac_ctx::metadata__cryptx_hmac_private_h"></span><span class="target" id="structcryptx__hmac__ctx_1a005cd807fe6ffe5f87c41ea296457270"></span><span class="n"><span class="pre">cryptx_hmac_private_h</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#_CPPv4N15cryptx_hmac_ctx8metadataE" title="Permalink to this definition"></a><br /></dt>
<dd><p>PRIVATE, INTERNAL. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416cryptx_hmac_initP15cryptx_hmac_ctxPKv6size_t7uint8_t">
<span id="_CPPv316cryptx_hmac_initP15cryptx_hmac_ctxPKv6size_t7uint8_t"></span><span id="_CPPv216cryptx_hmac_initP15cryptx_hmac_ctxPKv6size_t7uint8_t"></span><span id="cryptx_hmac_init__cryptx_hmac_ctxP.voidCP.s.uint8_t"></span><span class="target" id="cryptx_8h_1a21c854c0bcb6f7497516847e080c27c3"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_hmac_init</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv415cryptx_hmac_ctx" title="cryptx_hmac_ctx"><span class="n"><span class="pre">cryptx_hmac_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">key</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">keylen</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hash_alg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416cryptx_hmac_initP15cryptx_hmac_ctxPKv6size_t7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initializes an HMAC-state context for a specific hash algorithm. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Destroys 516 bytes of fastMem starting at 0xE30800. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to an HMAC-state context. </p></li>
<li><p><strong>key</strong> – Pointer to a key used to initialize the HMAC state. </p></li>
<li><p><strong>keylen</strong> – Length of the <strong>key</strong>. </p></li>
<li><p><strong>hash_alg</strong> – The numeric ID of the hashing algorithm to use. See <strong>cryptx_hash_algorithms</strong>. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>true</strong> if initialized succeeded, <strong>false</strong> if failed. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cryptx_hmac_updateP15cryptx_hmac_ctxPKv6size_t">
<span id="_CPPv318cryptx_hmac_updateP15cryptx_hmac_ctxPKv6size_t"></span><span id="_CPPv218cryptx_hmac_updateP15cryptx_hmac_ctxPKv6size_t"></span><span id="cryptx_hmac_update__cryptx_hmac_ctxP.voidCP.s"></span><span class="target" id="cryptx_8h_1a1ab7dcd49b5df0f9e697a5e14939d186"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_hmac_update</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv415cryptx_hmac_ctx" title="cryptx_hmac_ctx"><span class="n"><span class="pre">cryptx_hmac_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cryptx_hmac_updateP15cryptx_hmac_ctxPKv6size_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Updates the hash-state for a given block of data. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Destroys 516 bytes of fastMem starting at 0xE30800. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Calling this on a context that has not been initialized may have unpredictable results. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to an HMAC-state context. </p></li>
<li><p><strong>data</strong> – Pointer to a block of data to hash.. </p></li>
<li><p><strong>len</strong> – Size of the <strong>data</strong> to hash. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cryptx_hmac_digestP15cryptx_hmac_ctxPv">
<span id="_CPPv318cryptx_hmac_digestP15cryptx_hmac_ctxPv"></span><span id="_CPPv218cryptx_hmac_digestP15cryptx_hmac_ctxPv"></span><span id="cryptx_hmac_digest__cryptx_hmac_ctxP.voidP"></span><span class="target" id="cryptx_8h_1a710f6c433fa3e6d07c602a0fca5952d7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_hmac_digest</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv415cryptx_hmac_ctx" title="cryptx_hmac_ctx"><span class="n"><span class="pre">cryptx_hmac_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">digest</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cryptx_hmac_digestP15cryptx_hmac_ctxPv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Output digest for current HMAC-state (preserves state). </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>digest</strong> must be at large enough to hold the hash digest. You can retrieve the necessary size by accessing the <strong>digest_len</strong> member of an initialized <strong>cryptx_hmac_ctx</strong>. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Destroys 516 bytes of fastMem starting at 0xE30800. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Calling this on a context that has not been initialized may have unpredictable results. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to an HMAC-state context. </p></li>
<li><p><strong>digest</strong> – Pointer to a buffer to write digest to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="deriving-key-from-password">
<h3>Deriving Key from Password<a class="headerlink" href="#deriving-key-from-password" title="Permalink to this headline"></a></h3>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cryptx_hmac_pbkdf2PKc6size_tPKv6size_tP7uint8_t6size_t6size_t7uint8_t">
<span id="_CPPv318cryptx_hmac_pbkdf2PKc6size_tPKv6size_tP7uint8_t6size_t6size_t7uint8_t"></span><span id="_CPPv218cryptx_hmac_pbkdf2PKc6size_tPKv6size_tP7uint8_t6size_t6size_t7uint8_t"></span><span id="cryptx_hmac_pbkdf2__cCP.s.voidCP.s.uint8_tP.s.s.uint8_t"></span><span class="target" id="cryptx_8h_1a428a5da208ae3b55b73f4e05242148e8"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_hmac_pbkdf2</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">password</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">passlen</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">salt</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">saltlen</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">key</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">keylen</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rounds</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">hash_alg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cryptx_hmac_pbkdf2PKc6size_tPKv6size_tP7uint8_t6size_t6size_t7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Derives a key from a password, salt, and round count. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>NIST recommends a salt of at least 128 bits (16 bytes). </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>rounds</strong> is used to increase the cost (computational time) of generating a key. What makes a password-hashing algorithm secure is the time needed to generate a rainbow table attack against it. More rounds means a more secure key, but more time spent generating it. Current cryptography standards recommend thousands of rounds but that may not be feasible on the CE. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>password</strong> – Pointer to a string containing the password. </p></li>
<li><p><strong>passlen</strong> – Byte length of the password. </p></li>
<li><p><strong>salt</strong> – A psuedo-random string to use in each round of key derivation. </p></li>
<li><p><strong>saltlen</strong> – Byte length of the salt. </p></li>
<li><p><strong>rounds</strong> – The number of times to iterate the HMAC function per block of <strong>keylen</strong>. </p></li>
<li><p><strong>key</strong> – Pointer to buffer to write key to. </p></li>
<li><p><strong>keylen</strong> – Length of <strong>key</strong> to generate. </p></li>
<li><p><strong>hash_alg</strong> – The numeric ID of the hashing algorithm to use. See <strong>cryptx_hash_algorithms</strong>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="secure-random-number-generation">
<h3>Secure Random Number Generation<a class="headerlink" href="#secure-random-number-generation" title="Permalink to this headline"></a></h3>
<p>This random number generator is a hardware RNG. It works by reading repeatedly in XOR mode to an entropy pool from unmapped portions of SRAM until sufficient entropy is attained to return a random number. The input is passed through a cryptographic hash to ensure maximum distribution of entropy throughout the output.</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cryptx_csrand_initv">
<span id="_CPPv318cryptx_csrand_initv"></span><span id="_CPPv218cryptx_csrand_initv"></span><span id="cryptx_csrand_init__void"></span><span class="target" id="cryptx_8h_1aa4599a28ff439f7a21dbb0ce5772fa78"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_csrand_init</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cryptx_csrand_initv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initializes the (HW)RNG. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you forget to call this function, utilizing the RNG’s other functions will self-initialize the RNG. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>true</strong> on success, <strong>false</strong> on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417cryptx_csrand_getv">
<span id="_CPPv317cryptx_csrand_getv"></span><span id="_CPPv217cryptx_csrand_getv"></span><span id="cryptx_csrand_get__void"></span><span class="target" id="cryptx_8h_1a61b09a810e766ef1d2ff00c85ece63f2"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_csrand_get</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417cryptx_csrand_getv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Returns a securely psuedo-random 32-bit integer. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A securely psuedo-random 32-bit integer. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cryptx_csrand_fillPv6size_t">
<span id="_CPPv318cryptx_csrand_fillPv6size_t"></span><span id="_CPPv218cryptx_csrand_fillPv6size_t"></span><span id="cryptx_csrand_fill__voidP.s"></span><span class="target" id="cryptx_8h_1a8c550bae2fddbf8a04655325ba2c9e8f"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_csrand_fill</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buffer</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cryptx_csrand_fillPv6size_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Fills a buffer with securely pseduo-random bytes. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buffer</strong> – <strong>[in]</strong> Pointer to a buffer to fill with random bytes. </p></li>
<li><p><strong>size</strong> – <strong>[in]</strong> Size of the buffer to fill. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>true</strong> on success, <strong>false</strong> on failure. </p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>buffer</strong> filled to size. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="advanced-encryption-standard-aes">
<h3>Advanced Encryption Standard (AES)<a class="headerlink" href="#advanced-encryption-standard-aes" title="Permalink to this headline"></a></h3>
<p>AES is currently regarded as the gold standard for symmetric encryption. It is the primary encryption algorithm used in a secure session, after a (usually slower) key negotiation has succeeded. AES is fast and secure (to date it has not been broken if properly implemented). If you need the best possible security with this library, use AES-GCM cipher mode.</p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv414cryptx_aes_ctx">
<span id="_CPPv314cryptx_aes_ctx"></span><span id="_CPPv214cryptx_aes_ctx"></span><span id="cryptx_aes_ctx"></span><span class="target" id="structcryptx__aes__ctx"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_ctx</span></span></span><a class="headerlink" href="#_CPPv414cryptx_aes_ctx" title="Permalink to this definition"></a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14cryptx_aes_ctx7keysizeE">
<span id="_CPPv3N14cryptx_aes_ctx7keysizeE"></span><span id="_CPPv2N14cryptx_aes_ctx7keysizeE"></span><span id="cryptx_aes_ctx::keysize__uint24_t"></span><span class="target" id="structcryptx__aes__ctx_1aed50e8b9a653c1d20a0f324789ba8f84"></span><span class="n"><span class="pre">uint24_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">keysize</span></span></span><a class="headerlink" href="#_CPPv4N14cryptx_aes_ctx7keysizeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>the size of the key, in bits </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14cryptx_aes_ctx10round_keysE">
<span id="_CPPv3N14cryptx_aes_ctx10round_keysE"></span><span id="_CPPv2N14cryptx_aes_ctx10round_keysE"></span><span id="cryptx_aes_ctx::round_keys__uint32_tA"></span><span class="target" id="structcryptx__aes__ctx_1ab7564e0e5d2e1bd96b083f913eda1382"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">round_keys</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">60</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N14cryptx_aes_ctx10round_keysE" title="Permalink to this definition"></a><br /></dt>
<dd><p>round keys </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14cryptx_aes_ctx2ivE">
<span id="_CPPv3N14cryptx_aes_ctx2ivE"></span><span id="_CPPv2N14cryptx_aes_ctx2ivE"></span><span id="cryptx_aes_ctx::iv__uint8_tA"></span><span class="target" id="structcryptx__aes__ctx_1a3cc495f40d5a578c335fd03fe2772e4a"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">iv</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">16</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N14cryptx_aes_ctx2ivE" title="Permalink to this definition"></a><br /></dt>
<dd><p>IV state for next block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14cryptx_aes_ctx10ciphermodeE">
<span id="_CPPv3N14cryptx_aes_ctx10ciphermodeE"></span><span id="_CPPv2N14cryptx_aes_ctx10ciphermodeE"></span><span id="cryptx_aes_ctx::ciphermode__uint8_t"></span><span class="target" id="structcryptx__aes__ctx_1a46d05a8ea39c183bd6f09d5fa95bfe25"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ciphermode</span></span></span><a class="headerlink" href="#_CPPv4N14cryptx_aes_ctx10ciphermodeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>selected operational mode of the cipher </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14cryptx_aes_ctx8op_assocE">
<span id="_CPPv3N14cryptx_aes_ctx8op_assocE"></span><span id="_CPPv2N14cryptx_aes_ctx8op_assocE"></span><span id="cryptx_aes_ctx::op_assoc__uint8_t"></span><span class="target" id="structcryptx__aes__ctx_1af6a8c176ebacf1d1fc6a25b1ec2ec6d8"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">op_assoc</span></span></span><a class="headerlink" href="#_CPPv4N14cryptx_aes_ctx8op_assocE" title="Permalink to this definition"></a><br /></dt>
<dd><p>state-flag indicating if context is for encryption or decryption </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14cryptx_aes_ctx8metadataE">
<span id="_CPPv3N14cryptx_aes_ctx8metadataE"></span><span id="_CPPv2N14cryptx_aes_ctx8metadataE"></span><span id="cryptx_aes_ctx::metadata__cryptx_aes_private_h"></span><span class="target" id="structcryptx__aes__ctx_1a019c3bf1d587684ca720951dc0f390c3"></span><span class="n"><span class="pre">cryptx_aes_private_h</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#_CPPv4N14cryptx_aes_ctx8metadataE" title="Permalink to this definition"></a><br /></dt>
<dd><p>opague, internal context metadata </p>
</dd></dl>

</div>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Contexts are not bidirectional due to being stateful. If you need to process both encryption and decryption, initialize seperate contexts for encryption and decryption. Both contexts will use the same key, but different initialization vectors.</p>
<p>To prevent misuse, a context locks to the first operation it is used with and will return an error if used incorrectly.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is recommended to cycle your key after encrypting 2^64 blocks of data with the same key.</p>
<p>Do not manually edit the context structure. This will break the cipher configuration. If you want to change cipher modes, do so by calling <em>cryptx_aes_init</em> again.</p>
<p>CBC and CTR modes by themselves ensure confidentiality but do not provide any assurances of message integrity or authenticity. If you need a truly secure construction, use GCM mode or append a keyed hash (HMAC) to the encrypted message..</p>
</div>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv423cryptx_aes_cipher_modes">
<span id="_CPPv323cryptx_aes_cipher_modes"></span><span id="_CPPv223cryptx_aes_cipher_modes"></span><span class="target" id="cryptx_8h_1a59334db45c5435de6ded4492dec34735"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_cipher_modes</span></span></span><a class="headerlink" href="#_CPPv423cryptx_aes_cipher_modes" title="Permalink to this definition"></a><br /></dt>
<dd><p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N23cryptx_aes_cipher_modes12AES_MODE_CBCE">
<span id="_CPPv3N23cryptx_aes_cipher_modes12AES_MODE_CBCE"></span><span id="_CPPv2N23cryptx_aes_cipher_modes12AES_MODE_CBCE"></span><span class="target" id="cryptx_8h_1a59334db45c5435de6ded4492dec34735ad21a3698b98b7368b14ec3d48314a132"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_MODE_CBC</span></span></span><a class="headerlink" href="#_CPPv4N23cryptx_aes_cipher_modes12AES_MODE_CBCE" title="Permalink to this definition"></a><br /></dt>
<dd><p>selects Cyclic Block Chain (CBC) mode </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N23cryptx_aes_cipher_modes12AES_MODE_CTRE">
<span id="_CPPv3N23cryptx_aes_cipher_modes12AES_MODE_CTRE"></span><span id="_CPPv2N23cryptx_aes_cipher_modes12AES_MODE_CTRE"></span><span class="target" id="cryptx_8h_1a59334db45c5435de6ded4492dec34735a5ecd63cd0bd97d46f273461b6550cb8e"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_MODE_CTR</span></span></span><a class="headerlink" href="#_CPPv4N23cryptx_aes_cipher_modes12AES_MODE_CTRE" title="Permalink to this definition"></a><br /></dt>
<dd><p>selects Counter (CTR) mode </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N23cryptx_aes_cipher_modes12AES_MODE_GCME">
<span id="_CPPv3N23cryptx_aes_cipher_modes12AES_MODE_GCME"></span><span id="_CPPv2N23cryptx_aes_cipher_modes12AES_MODE_GCME"></span><span class="target" id="cryptx_8h_1a59334db45c5435de6ded4492dec34735aa41ebb36bc19b64d64ff6b7fc0d5e5df"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_MODE_GCM</span></span></span><a class="headerlink" href="#_CPPv4N23cryptx_aes_cipher_modes12AES_MODE_GCME" title="Permalink to this definition"></a><br /></dt>
<dd><p>selects Galois Counter (GCM) mode </p>
</dd></dl>

</dd></dl>

<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv426cryptx_aes_padding_schemes">
<span id="_CPPv326cryptx_aes_padding_schemes"></span><span id="_CPPv226cryptx_aes_padding_schemes"></span><span class="target" id="cryptx_8h_1a66b61f98ab7705ff93bde98685ff3433"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_padding_schemes</span></span></span><a class="headerlink" href="#_CPPv426cryptx_aes_padding_schemes" title="Permalink to this definition"></a><br /></dt>
<dd><p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N26cryptx_aes_padding_schemes9PAD_PKCS7E">
<span id="_CPPv3N26cryptx_aes_padding_schemes9PAD_PKCS7E"></span><span id="_CPPv2N26cryptx_aes_padding_schemes9PAD_PKCS7E"></span><span class="target" id="cryptx_8h_1a66b61f98ab7705ff93bde98685ff3433a673ae2fee0bfe0a962717b3f673b9b7c"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PAD_PKCS7</span></span></span><a class="headerlink" href="#_CPPv4N26cryptx_aes_padding_schemes9PAD_PKCS7E" title="Permalink to this definition"></a><br /></dt>
<dd><p>PKCS#7 padding | DEFAULT. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N26cryptx_aes_padding_schemes11PAD_DEFAULTE">
<span id="_CPPv3N26cryptx_aes_padding_schemes11PAD_DEFAULTE"></span><span id="_CPPv2N26cryptx_aes_padding_schemes11PAD_DEFAULTE"></span><span class="target" id="cryptx_8h_1a66b61f98ab7705ff93bde98685ff3433a322c11c9058ef67073a3ff9bdcb9f759"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PAD_DEFAULT</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N26cryptx_aes_padding_schemes9PAD_PKCS7E" title="cryptx_aes_padding_schemes::PAD_PKCS7"><span class="n"><span class="pre">PAD_PKCS7</span></span></a><a class="headerlink" href="#_CPPv4N26cryptx_aes_padding_schemes11PAD_DEFAULTE" title="Permalink to this definition"></a><br /></dt>
<dd><p>selects the scheme marked DEFAULT. </p>
<p>Using this is recommended in case a change to the standards would set a stronger padding scheme as default </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N26cryptx_aes_padding_schemes8PAD_ISO2E">
<span id="_CPPv3N26cryptx_aes_padding_schemes8PAD_ISO2E"></span><span id="_CPPv2N26cryptx_aes_padding_schemes8PAD_ISO2E"></span><span class="target" id="cryptx_8h_1a66b61f98ab7705ff93bde98685ff3433a7566d9371110a1a24db62b145c901ad8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PAD_ISO2</span></span></span><a class="headerlink" href="#_CPPv4N26cryptx_aes_padding_schemes8PAD_ISO2E" title="Permalink to this definition"></a><br /></dt>
<dd><p>ISO-9797 M2 padding. </p>
</dd></dl>

</dd></dl>

<p>Here are some macros to assist with defining buffers for keys of supported length.</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_AES_128_KEYLEN">
<span class="target" id="cryptx_8h_1aa08392858444e1cc894d5f98432411c9"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_128_KEYLEN</span></span></span><a class="headerlink" href="#c.CRYPTX_AES_128_KEYLEN" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_AES_192_KEYLEN">
<span class="target" id="cryptx_8h_1a0ceacc8bb81e6ef0f60bbe736732e5e0"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_192_KEYLEN</span></span></span><a class="headerlink" href="#c.CRYPTX_AES_192_KEYLEN" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_AES_256_KEYLEN">
<span class="target" id="cryptx_8h_1acb2aea7855878c1b9b505ecb9b9583b1"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_256_KEYLEN</span></span></span><a class="headerlink" href="#c.CRYPTX_AES_256_KEYLEN" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<p>And here are some macros defining properties of the cipher.</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_AES_BLOCK_SIZE">
<span class="target" id="cryptx_8h_1a2d638028c68c84297614a1dc7ff318d9"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_BLOCK_SIZE</span></span></span><a class="headerlink" href="#c.CRYPTX_AES_BLOCK_SIZE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_AES_IV_SIZE">
<span class="target" id="cryptx_8h_1ac47330f91ba12f7856c0c198bdbf2753"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_IV_SIZE</span></span></span><a class="headerlink" href="#c.CRYPTX_AES_IV_SIZE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_AES_AUTHTAG_SIZE">
<span class="target" id="cryptx_8h_1a89521b82b1be81ea3e5f70c3593bf5a9"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_AUTHTAG_SIZE</span></span></span><a class="headerlink" href="#c.CRYPTX_AES_AUTHTAG_SIZE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<p>Some macros for passing cipher configuration options to <em>cryptx_aes_init</em>.</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_AES_CBC_FLAGS">
<span class="target" id="cryptx_8h_1af0f7e8aa23de8ecc99b2420efefa4edc"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_CBC_FLAGS</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">padding_mode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.CRYPTX_AES_CBC_FLAGS" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines a macro to enable AES CBC cipher mode and pass relevant configuration options. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_AES_CTR_FLAGS">
<span class="target" id="cryptx_8h_1a0ed8d02473b9a003653db30e1d856614"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_CTR_FLAGS</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">nonce_len</span></span>, <span class="n"><span class="pre">counter_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.CRYPTX_AES_CTR_FLAGS" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines a macro to enable AES CTR cipher mode and pass relevant configuration options. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_AES_GCM_FLAGS">
<span class="target" id="cryptx_8h_1ac0de9d43e9ef5718060b164bf71e3ae0"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_AES_GCM_FLAGS</span></span></span><a class="headerlink" href="#c.CRYPTX_AES_GCM_FLAGS" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines a macro to enable AES GCM cipher mode. </p>
</dd></dl>

<p>This macro returns the full size required by the ciphertext. This really only applies to CBC mode. CTR and GCM modes have the same ciphertext and plaintext length.</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.cryptx_aes_get_ciphertext_len">
<span class="target" id="cryptx_8h_1adf4062c77f37927bc0178872056602ff"></span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_get_ciphertext_len</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cryptx_aes_get_ciphertext_len" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines a macro to return the byte length of an AES ciphertext given a plaintext length. </p>
</dd></dl>

<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv411aes_error_t">
<span id="_CPPv311aes_error_t"></span><span id="_CPPv211aes_error_t"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfd"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">aes_error_t</span></span></span><a class="headerlink" href="#_CPPv411aes_error_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines response codes returned by the AES API. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t6AES_OKE">
<span id="_CPPv3N11aes_error_t6AES_OKE"></span><span id="_CPPv2N11aes_error_t6AES_OKE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfdaacf07636102724d2a7913911b0cf74b2"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_OK</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t6AES_OKE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation completed successfully. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t15AES_INVALID_ARGE">
<span id="_CPPv3N11aes_error_t15AES_INVALID_ARGE"></span><span id="_CPPv2N11aes_error_t15AES_INVALID_ARGE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfda6d39b280aea9d8d62d126eef05d271db"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_INVALID_ARG</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t15AES_INVALID_ARGE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation failed, bad argument. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t15AES_INVALID_MSGE">
<span id="_CPPv3N11aes_error_t15AES_INVALID_MSGE"></span><span id="_CPPv2N11aes_error_t15AES_INVALID_MSGE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfdaae5e9a591aeda666b0e425d9a05834e3"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_INVALID_MSG</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t15AES_INVALID_MSGE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation failed, message invalid. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t22AES_INVALID_CIPHERMODEE">
<span id="_CPPv3N11aes_error_t22AES_INVALID_CIPHERMODEE"></span><span id="_CPPv2N11aes_error_t22AES_INVALID_CIPHERMODEE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfdad2b49ffeabf14aaf47db3d1bad18f84e"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_INVALID_CIPHERMODE</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t22AES_INVALID_CIPHERMODEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation failed, cipher mode undefined. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t23AES_INVALID_PADDINGMODEE">
<span id="_CPPv3N11aes_error_t23AES_INVALID_PADDINGMODEE"></span><span id="_CPPv2N11aes_error_t23AES_INVALID_PADDINGMODEE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfda47bbd593fc3bdb7758a790bab86b41d9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_INVALID_PADDINGMODE</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t23AES_INVALID_PADDINGMODEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation failed, padding mode undefined. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t22AES_INVALID_CIPHERTEXTE">
<span id="_CPPv3N11aes_error_t22AES_INVALID_CIPHERTEXTE"></span><span id="_CPPv2N11aes_error_t22AES_INVALID_CIPHERTEXTE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfdaba928751c773ffa0287e47e1f86eae8b"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_INVALID_CIPHERTEXT</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t22AES_INVALID_CIPHERTEXTE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation failed, ciphertext error. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11aes_error_t21AES_INVALID_OPERATIONE">
<span id="_CPPv3N11aes_error_t21AES_INVALID_OPERATIONE"></span><span id="_CPPv2N11aes_error_t21AES_INVALID_OPERATIONE"></span><span class="target" id="cryptx_8h_1aeb2e64abcc4317e3143fb820f21c3bfda95a9dcbf64347e3c6f2c50d05e8937f5"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_INVALID_OPERATION</span></span></span><a class="headerlink" href="#_CPPv4N11aes_error_t21AES_INVALID_OPERATIONE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES operation failed, used encrypt context for decrypt or vice versa. </p>
</dd></dl>

</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415cryptx_aes_initP14cryptx_aes_ctxPKv6size_tPKv6size_t8uint24_t">
<span id="_CPPv315cryptx_aes_initP14cryptx_aes_ctxPKv6size_tPKv6size_t8uint24_t"></span><span id="_CPPv215cryptx_aes_initP14cryptx_aes_ctxPKv6size_tPKv6size_t8uint24_t"></span><span id="cryptx_aes_init__cryptx_aes_ctxP.voidCP.s.voidCP.s.uint24_t"></span><span class="target" id="cryptx_8h_1aee9ba52b80ab5bddd81193cdf26389e2"></span><a class="reference internal" href="#_CPPv411aes_error_t" title="aes_error_t"><span class="n"><span class="pre">aes_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_init</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv414cryptx_aes_ctx" title="cryptx_aes_ctx"><span class="n"><span class="pre">cryptx_aes_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">key</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">keylen</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">iv</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ivlen</span></span>, <span class="n"><span class="pre">uint24_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">flags</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415cryptx_aes_initP14cryptx_aes_ctxPKv6size_tPKv6size_t8uint24_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initializes a stateful AES cipher context to be used for encryption or decryption. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to an AES cipher context to initialize. </p></li>
<li><p><strong>key</strong> – Pointer to an 128, 192, or 256 bit key to load into the AES context. </p></li>
<li><p><strong>keylen</strong> – The size, in bytes, of the <strong>key</strong> to load. </p></li>
<li><p><strong>iv</strong> – Pointer to Initialization vector, a buffer equal to the block size filled with random bytes. </p></li>
<li><p><strong>ivlen</strong> – Length of the initalization vector. Capped at 16 bytes. Certain cipher modes have different recommendations. </p></li>
<li><p><strong>flags</strong> – A series of flags to configure the AES context with. Use the provided <strong>CRYPTX_AES_CTR_FLAGS</strong>, <strong>CRYPTX_AES_CBC_FLAGS</strong>, or <strong>CRYPTX_AES_GCM_FLAGS</strong> to pass flags. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <strong>aes_error_t</strong> indicating the status of the AES operation. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cryptx_aes_encryptPK14cryptx_aes_ctxPKv6size_tPv">
<span id="_CPPv318cryptx_aes_encryptPK14cryptx_aes_ctxPKv6size_tPv"></span><span id="_CPPv218cryptx_aes_encryptPK14cryptx_aes_ctxPKv6size_tPv"></span><span id="cryptx_aes_encrypt__cryptx_aes_ctxCP.voidCP.s.voidP"></span><span class="target" id="cryptx_8h_1a571d4b9eb0fe3d069b10492025e47fe0"></span><a class="reference internal" href="#_CPPv411aes_error_t" title="aes_error_t"><span class="n"><span class="pre">aes_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_encrypt</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv414cryptx_aes_ctx" title="cryptx_aes_ctx"><span class="n"><span class="pre">cryptx_aes_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">plaintext</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">len</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ciphertext</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cryptx_aes_encryptPK14cryptx_aes_ctxPKv6size_tPv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Performs a stateful AES encryption of an arbitrary length of data. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>ciphertext</strong> should large enough to hold the encrypted message. See the <strong>cryptx_aes_get_ciphertext_len</strong> macro for CBC mode. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>plaintext</strong> and <strong>ciphertext</strong> are aliasable. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Encrypt is streamable, such that <span class="math notranslate nohighlight">\( encrypt(msg1) + encrypt(msg2) \)</span> is functionally identical to <span class="math notranslate nohighlight">\( encrypt(msg1+msg2) \)</span> with the exception of intervening padding in CBC mode. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to an AES cipher context. </p></li>
<li><p><strong>plaintext</strong> – Pointer to data to encrypt. </p></li>
<li><p><strong>len</strong> – Length of data at <strong>plaintext</strong> to encrypt. </p></li>
<li><p><strong>ciphertext</strong> – Pointer to buffer to write encrypted data to. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <strong>aes_error_t</strong> indicating the status of the AES operation. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cryptx_aes_decryptPK14cryptx_aes_ctxPKv6size_tPv">
<span id="_CPPv318cryptx_aes_decryptPK14cryptx_aes_ctxPKv6size_tPv"></span><span id="_CPPv218cryptx_aes_decryptPK14cryptx_aes_ctxPKv6size_tPv"></span><span id="cryptx_aes_decrypt__cryptx_aes_ctxCP.voidCP.s.voidP"></span><span class="target" id="cryptx_8h_1ab5cf162f80d83c86c9dbba9aa866b289"></span><a class="reference internal" href="#_CPPv411aes_error_t" title="aes_error_t"><span class="n"><span class="pre">aes_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_decrypt</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv414cryptx_aes_ctx" title="cryptx_aes_ctx"><span class="n"><span class="pre">cryptx_aes_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ciphertext</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">len</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">plaintext</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cryptx_aes_decryptPK14cryptx_aes_ctxPKv6size_tPv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Performs a stateful AES decryption of an arbitrary length of data. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>plaintext</strong> and <strong>ciphertext</strong> are aliasable. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Decrypt is streamable, such that <span class="math notranslate nohighlight">\( decrypt(msg1) + decrypt(msg2) \)</span> is functionally identical to <span class="math notranslate nohighlight">\( decrypt(msg1+msg2) \)</span> with the exception of intervening padding in CBC mode. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to AES cipher context. </p></li>
<li><p><strong>ciphertext</strong> – Pointer to data to decrypt. </p></li>
<li><p><strong>len</strong> – Length of data at <strong>ciphertext</strong> to decrypt. </p></li>
<li><p><strong>plaintext</strong> – Pointer to buffer to write decryped data to. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <strong>aes_error_t</strong> indicating the status of the AES operation. </p>
</dd>
</dl>
</dd></dl>

<p>The following functions are only valid for Galois Counter Mode (GCM). Attempting to use them for any other cipher mode will return <strong>AES_INVALID_CIPHERMODE</strong>.</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421cryptx_aes_update_aadP14cryptx_aes_ctxPKv6size_t">
<span id="_CPPv321cryptx_aes_update_aadP14cryptx_aes_ctxPKv6size_t"></span><span id="_CPPv221cryptx_aes_update_aadP14cryptx_aes_ctxPKv6size_t"></span><span id="cryptx_aes_update_aad__cryptx_aes_ctxP.voidCP.s"></span><span class="target" id="cryptx_8h_1a3d55233d4178e3f6c6b96272fda56ae0"></span><a class="reference internal" href="#_CPPv411aes_error_t" title="aes_error_t"><span class="n"><span class="pre">aes_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_update_aad</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv414cryptx_aes_ctx" title="cryptx_aes_ctx"><span class="n"><span class="pre">cryptx_aes_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">aad</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">aad_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421cryptx_aes_update_aadP14cryptx_aes_ctxPKv6size_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Updates the cipher context for given AAD (Additional Authenticated Data). </p>
<p>AAD is data that is only authenticated, not encrypted. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function can only be called between cipher initialization and encryption/decryption. Attempting to call this function at any other time will return <strong>AES_INVALID_OPERATION</strong>. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to an AES context. </p></li>
<li><p><strong>aad</strong> – Pointer to additional authenticated data segment. </p></li>
<li><p><strong>aad_len</strong> – Length of additional data segment. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <strong>aes_error_t</strong> indicating the status of the AES operation. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417cryptx_aes_digestP14cryptx_aes_ctxP7uint8_t">
<span id="_CPPv317cryptx_aes_digestP14cryptx_aes_ctxP7uint8_t"></span><span id="_CPPv217cryptx_aes_digestP14cryptx_aes_ctxP7uint8_t"></span><span id="cryptx_aes_digest__cryptx_aes_ctxP.uint8_tP"></span><span class="target" id="cryptx_8h_1a7aaae6b33efe97c579d24729680eda79"></span><a class="reference internal" href="#_CPPv411aes_error_t" title="aes_error_t"><span class="n"><span class="pre">aes_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_digest</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv414cryptx_aes_ctx" title="cryptx_aes_ctx"><span class="n"><span class="pre">cryptx_aes_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">digest</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417cryptx_aes_digestP14cryptx_aes_ctxP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Returns the current authentication tag for data parsed so far. </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Nonce-misuse vulnerability/forbidden attack</strong>: GCM is vulnerable to key discovery if the same nonce is reused to encrypt or decrypt multiple messages. Once you generate a digest for data processed by the cipher, cycle the nonce by generating a new one and calling <strong>cryptx_aes_init</strong> again with the new nonce. To ensure this is done properly, the context is marked invalid once this function is called. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to an AES context </p></li>
<li><p><strong>digest</strong> – Pointer to a buffer to output digest to. Must be at least 16 bytes large. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <strong>aes_error_t</strong> indicating the status of the AES operation. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417cryptx_aes_verifyPK14cryptx_aes_ctxPKv6size_tPKv6size_tP7uint8_t">
<span id="_CPPv317cryptx_aes_verifyPK14cryptx_aes_ctxPKv6size_tPKv6size_tP7uint8_t"></span><span id="_CPPv217cryptx_aes_verifyPK14cryptx_aes_ctxPKv6size_tPKv6size_tP7uint8_t"></span><span id="cryptx_aes_verify__cryptx_aes_ctxCP.voidCP.s.voidCP.s.uint8_tP"></span><span class="target" id="cryptx_8h_1a69437bd1ca1d4fe40dc50d91da7c1be4"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_aes_verify</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv414cryptx_aes_ctx" title="cryptx_aes_ctx"><span class="n"><span class="pre">cryptx_aes_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">context</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">aad</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">aad_len</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ciphertext</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ciphertext_len</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">tag</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417cryptx_aes_verifyPK14cryptx_aes_ctxPKv6size_tPKv6size_tP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Parses the specified AAD and ciphertext and then compares the output auth tag to an expected auth tag. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If this function returns FALSE, do not decrypt the message. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – Pointer to an AES context. </p></li>
<li><p><strong>aad</strong> – Pointer to associated data to authenticate. </p></li>
<li><p><strong>aad_len</strong> – Length of associated data to authenticate. </p></li>
<li><p><strong>ciphertext</strong> – Pointer to ciphertext to authenticate. </p></li>
<li><p><strong>ciphertext_len</strong> – Length of ciphertext to authenticate. </p></li>
<li><p><strong>tag</strong> – Pointer to expected auth tag to validate against. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TRUE if authentication tag matches expected, FALSE otherwise. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="rivest-shamir-adleman-rsa">
<h3>Rivest-Shamir-Adleman (RSA)<a class="headerlink" href="#rivest-shamir-adleman-rsa" title="Permalink to this headline"></a></h3>
<p>RSA is currently one of the most commonly used key exchange/public key encryption methods. It is commonly used to share a secret for symmetric encryption (such as AES) at the start of a secure session. In recent times, however, RSA has been becoming easier to defeat due to advances in computing. This implementation is encrypt-only, supports modulus length between 1024 and 2048 bits, and uses a public exponent of <span class="math notranslate nohighlight">\(2^{2^4} + 1\)</span> or 65,537.</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_RSA_MODULUS_MAX">
<span class="target" id="cryptx_8h_1a265dcd336b31e2b95870d864c85cee2a"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_RSA_MODULUS_MAX</span></span></span><a class="headerlink" href="#c.CRYPTX_RSA_MODULUS_MAX" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines the maximum byte length of an RSA public modulus supported by this library. </p>
</dd></dl>

<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv411rsa_error_t">
<span id="_CPPv311rsa_error_t"></span><span id="_CPPv211rsa_error_t"></span><span class="target" id="cryptx_8h_1a0486449f609d0e485bad091a671d9294"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rsa_error_t</span></span></span><a class="headerlink" href="#_CPPv411rsa_error_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines response codes returned by calls to the RSA API. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11rsa_error_t6RSA_OKE">
<span id="_CPPv3N11rsa_error_t6RSA_OKE"></span><span id="_CPPv2N11rsa_error_t6RSA_OKE"></span><span class="target" id="cryptx_8h_1a0486449f609d0e485bad091a671d9294a2cafdb683e1870a33bcb821420626cae"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RSA_OK</span></span></span><a class="headerlink" href="#_CPPv4N11rsa_error_t6RSA_OKE" title="Permalink to this definition"></a><br /></dt>
<dd><p>RSA encryption completed successfully. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11rsa_error_t15RSA_INVALID_ARGE">
<span id="_CPPv3N11rsa_error_t15RSA_INVALID_ARGE"></span><span id="_CPPv2N11rsa_error_t15RSA_INVALID_ARGE"></span><span class="target" id="cryptx_8h_1a0486449f609d0e485bad091a671d9294aab9ab38286c4180a1aa9f6e8df42e5db"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RSA_INVALID_ARG</span></span></span><a class="headerlink" href="#_CPPv4N11rsa_error_t15RSA_INVALID_ARGE" title="Permalink to this definition"></a><br /></dt>
<dd><p>RSA encryption failed, bad argument. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11rsa_error_t15RSA_INVALID_MSGE">
<span id="_CPPv3N11rsa_error_t15RSA_INVALID_MSGE"></span><span id="_CPPv2N11rsa_error_t15RSA_INVALID_MSGE"></span><span class="target" id="cryptx_8h_1a0486449f609d0e485bad091a671d9294aedeb18a96b96e292369abed5b2f0a271"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RSA_INVALID_MSG</span></span></span><a class="headerlink" href="#_CPPv4N11rsa_error_t15RSA_INVALID_MSGE" title="Permalink to this definition"></a><br /></dt>
<dd><p>RSA encryption failed, bad msg or msg too long. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11rsa_error_t19RSA_INVALID_MODULUSE">
<span id="_CPPv3N11rsa_error_t19RSA_INVALID_MODULUSE"></span><span id="_CPPv2N11rsa_error_t19RSA_INVALID_MODULUSE"></span><span class="target" id="cryptx_8h_1a0486449f609d0e485bad091a671d9294a843ec210de66176ef63e2d2b8ebdeb65"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RSA_INVALID_MODULUS</span></span></span><a class="headerlink" href="#_CPPv4N11rsa_error_t19RSA_INVALID_MODULUSE" title="Permalink to this definition"></a><br /></dt>
<dd><p>RSA encryption failed, modulus invalid. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11rsa_error_t18RSA_ENCODING_ERRORE">
<span id="_CPPv3N11rsa_error_t18RSA_ENCODING_ERRORE"></span><span id="_CPPv2N11rsa_error_t18RSA_ENCODING_ERRORE"></span><span class="target" id="cryptx_8h_1a0486449f609d0e485bad091a671d9294a43eadc89540121b902e02afabc7a7eb9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RSA_ENCODING_ERROR</span></span></span><a class="headerlink" href="#_CPPv4N11rsa_error_t18RSA_ENCODING_ERRORE" title="Permalink to this definition"></a><br /></dt>
<dd><p>RSA encryption failed, OAEP encoding error. </p>
</dd></dl>

</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cryptx_rsa_encryptPKv6size_tPKv6size_tPv7uint8_t">
<span id="_CPPv318cryptx_rsa_encryptPKv6size_tPKv6size_tPv7uint8_t"></span><span id="_CPPv218cryptx_rsa_encryptPKv6size_tPKv6size_tPv7uint8_t"></span><span id="cryptx_rsa_encrypt__voidCP.s.voidCP.s.voidP.uint8_t"></span><span class="target" id="cryptx_8h_1aa4f5ae1eb3d9636c20dec64503a4896b"></span><a class="reference internal" href="#_CPPv411rsa_error_t" title="rsa_error_t"><span class="n"><span class="pre">rsa_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_rsa_encrypt</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">msg</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">msglen</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pubkey</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">keylen</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ciphertext</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">oaep_hash_alg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cryptx_rsa_encryptPKv6size_tPKv6size_tPv7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Encrypts a message using the given RSA public key. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>ciphertext</strong> should be at least <strong>msglen</strong> bytes large. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>OAEP encoding is applied to the message as part of the encryption. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> – Pointer to a message to encrypt using RSA. </p></li>
<li><p><strong>msglen</strong> – The byte length of the <strong>msg</strong>. </p></li>
<li><p><strong>pubkey</strong> – Pointer to a public key to use for encryption. </p></li>
<li><p><strong>keylen</strong> – The length of the public key (modulus) to encrypt with. </p></li>
<li><p><strong>ciphertext</strong> – Pointer a buffer to write the ciphertext to. </p></li>
<li><p><strong>oaep_hash_alg</strong> – The numeric ID of the hashing algorithm to use within OAEP encoding. See <strong>cryptx_hash_algorithms</strong>. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <strong>rsa_error_t</strong> indicating the status of the RSA operation. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="elliptic-curve-diffie-hellman">
<h3>Elliptic Curve Diffie-Hellman<a class="headerlink" href="#elliptic-curve-diffie-hellman" title="Permalink to this headline"></a></h3>
<p>Elliptic curves are a newer introduction to cryptography and they boast more security than more traditional algorithms. For example, in order to achieve the same security level you would have with a 2048-bit RSA key, you need only around 240 bits. <strong>Elliptic Curve Diffie-Hellman</strong> is a variation on standard Diffie-Hellman that uses elliptic curves to transform a private key into a public key.</p>
<p><strong>Standard Diffie-Hellman</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;pubkey = G^{privkey} \mod m \\
&amp;secret = rpubkey^{privkey} \mod m \\
&amp;where: \\
&amp;G = public\_base \\
&amp;m = public\_modulus\end{split}\]</div>
<p><strong>Elliptic Curve Diffie-Hellman</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;pubkey = G * privkey \\
&amp;secret = rpubkey * privkey * cofactor \\
&amp;where: \\
&amp;G = base\_point\_on\_curve\end{split}\]</div>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_ECDH_PRIVKEY_LEN">
<span class="target" id="cryptx_8h_1ac753c393f9a2f85ebd589ed14823ccd7"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_ECDH_PRIVKEY_LEN</span></span></span><a class="headerlink" href="#c.CRYPTX_ECDH_PRIVKEY_LEN" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines the byte length of an ECDH private key supported by this library. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_ECDH_PUBKEY_LEN">
<span class="target" id="cryptx_8h_1ad75ef28855bfeec84da3e324494c3082"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_ECDH_PUBKEY_LEN</span></span></span><a class="headerlink" href="#c.CRYPTX_ECDH_PUBKEY_LEN" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines the byte length of an ECDH public key supported by this library. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CRYPTX_ECDH_SECRET_LEN">
<span class="target" id="cryptx_8h_1aa95fc648d6050a2e47e08f24176167c6"></span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTX_ECDH_SECRET_LEN</span></span></span><a class="headerlink" href="#c.CRYPTX_ECDH_SECRET_LEN" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.cryptx_ecdh_generate_privkey">
<span class="target" id="cryptx_8h_1a1bd4fb56d54940c2534049e2a5a73351"></span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_ecdh_generate_privkey</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">privkey</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cryptx_ecdh_generate_privkey" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines a macro to fill an ECDH private key with random bytes. </p>
</dd></dl>

<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv412ecdh_error_t">
<span id="_CPPv312ecdh_error_t"></span><span id="_CPPv212ecdh_error_t"></span><span class="target" id="cryptx_8h_1a0aa0891afd8596f5fc0624b07a939944"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ecdh_error_t</span></span></span><a class="headerlink" href="#_CPPv412ecdh_error_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Defines possible response codes from calls to the ECDH API. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N12ecdh_error_t7ECDH_OKE">
<span id="_CPPv3N12ecdh_error_t7ECDH_OKE"></span><span id="_CPPv2N12ecdh_error_t7ECDH_OKE"></span><span class="target" id="cryptx_8h_1a0aa0891afd8596f5fc0624b07a939944a1fc3b5fa5eb8adaa46a9257ee782acbb"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ECDH_OK</span></span></span><a class="headerlink" href="#_CPPv4N12ecdh_error_t7ECDH_OKE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N12ecdh_error_t16ECDH_INVALID_ARGE">
<span id="_CPPv3N12ecdh_error_t16ECDH_INVALID_ARGE"></span><span id="_CPPv2N12ecdh_error_t16ECDH_INVALID_ARGE"></span><span class="target" id="cryptx_8h_1a0aa0891afd8596f5fc0624b07a939944a635480018ca2a67bd5994a91091abc5a"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ECDH_INVALID_ARG</span></span></span><a class="headerlink" href="#_CPPv4N12ecdh_error_t16ECDH_INVALID_ARGE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N12ecdh_error_t20ECDH_PRIVKEY_INVALIDE">
<span id="_CPPv3N12ecdh_error_t20ECDH_PRIVKEY_INVALIDE"></span><span id="_CPPv2N12ecdh_error_t20ECDH_PRIVKEY_INVALIDE"></span><span class="target" id="cryptx_8h_1a0aa0891afd8596f5fc0624b07a939944a761fc8a34f1342ebe085e06300fb907f"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ECDH_PRIVKEY_INVALID</span></span></span><a class="headerlink" href="#_CPPv4N12ecdh_error_t20ECDH_PRIVKEY_INVALIDE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N12ecdh_error_t20ECDH_RPUBKEY_INVALIDE">
<span id="_CPPv3N12ecdh_error_t20ECDH_RPUBKEY_INVALIDE"></span><span id="_CPPv2N12ecdh_error_t20ECDH_RPUBKEY_INVALIDE"></span><span class="target" id="cryptx_8h_1a0aa0891afd8596f5fc0624b07a939944a6bb841ab7c886611c50ce3e4a8bcdf08"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ECDH_RPUBKEY_INVALID</span></span></span><a class="headerlink" href="#_CPPv4N12ecdh_error_t20ECDH_RPUBKEY_INVALIDE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421cryptx_ecdh_publickeyPK7uint8_tP7uint8_t">
<span id="_CPPv321cryptx_ecdh_publickeyPK7uint8_tP7uint8_t"></span><span id="_CPPv221cryptx_ecdh_publickeyPK7uint8_tP7uint8_t"></span><span id="cryptx_ecdh_publickey__uint8_tCP.uint8_tP"></span><span class="target" id="cryptx_8h_1a495fa773d3d4c650a289c7da236a8026"></span><a class="reference internal" href="#_CPPv412ecdh_error_t" title="ecdh_error_t"><span class="n"><span class="pre">ecdh_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_ecdh_publickey</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">privkey</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pubkey</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421cryptx_ecdh_publickeyPK7uint8_tP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Generates a public key from the private key and some base point G on curve. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Output public key is a point on the curve expressed as two 30-byte coordinates encoded in little endian byte order and padded with zeros (if needed). You may have to deserialize the key and then serialize it into a different format to use it with some encryption libraries. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function expects that <strong>privkey</strong> be filled with random bytes. Failure to do so may cause unexpected behavior. See <strong><a class="reference internal" href="#cryptx_8h_1a1bd4fb56d54940c2534049e2a5a73351"><span class="std std-ref">cryptx_ecdh_generate_privkey()</span></a></strong>. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>privkey</strong> – Pointer to a randomized ECDH private key. </p></li>
<li><p><strong>pubkey</strong> – Pointer to buffer to write public key. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418cryptx_ecdh_secretPK7uint8_tPK7uint8_tP7uint8_t">
<span id="_CPPv318cryptx_ecdh_secretPK7uint8_tPK7uint8_tP7uint8_t"></span><span id="_CPPv218cryptx_ecdh_secretPK7uint8_tPK7uint8_tP7uint8_t"></span><span id="cryptx_ecdh_secret__uint8_tCP.uint8_tCP.uint8_tP"></span><span class="target" id="cryptx_8h_1ad975a0ac10f02d9509081ae57f790f50"></span><a class="reference internal" href="#_CPPv412ecdh_error_t" title="ecdh_error_t"><span class="n"><span class="pre">ecdh_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cryptx_ecdh_secret</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">privkey</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rpubkey</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">secret</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418cryptx_ecdh_secretPK7uint8_tPK7uint8_tP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Computes a secret from the private key and the remote public key. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>secret</strong> must be at least <strong>CRYPTX_ECDH_SECRET_LEN</strong> bytes. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Output secret is a point on the curve expressed as two 30-byte coordinates encoded in little endian byte order and padded with zeros if needed. You may have to deserialize the secret and then serialize it into a different format for compatibility with other encryption libraries. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is generally not recommended to use the computed secret as an encryption key as is. It is preferred to pass the secret to a KDF or a cryptographic primitive such as a hash function and use that output as your symmetric key. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>privkey</strong> – Pointer to local private key. </p></li>
<li><p><strong>rpubkey</strong> – Pointer to remote public key. </p></li>
<li><p><strong>secret</strong> – Pointer to buffer to write shared secret to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="static/analysis.html" class="btn btn-neutral float-right" title="CryptX Analysis &amp; Overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>